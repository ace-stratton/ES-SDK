<!-- HTML header for doxygen 1.9.5-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="$langISO">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.4"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>EnduroSat On-Board Computer SDK Documentation: /builds/sw-platform-es/modules/on-boardcomputer/stm32f/obc-stdpf-hw-1.x/espf/core/services/nvm/src/nvm.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
$darkmode
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><a href="../../index.html"><img alt="Logo" src="EnduroSat_horLogo_symbol@2x-min.png"/></a></td>
  <td id="projectalign">
   <div id="projectname">EnduroSat On-Board Computer SDK Documentation
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.4 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('nvm_8c.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#enum-members">Enumerations</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">nvm.c File Reference<div class="ingroups"><a class="el" href="group___services.html">Services</a> &raquo; <a class="el" href="group___nvm.html">Nvm</a></div></div></div>
</div><!--header-->
<div class="contents">

<p>NVM service core implementation.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;string.h&gt;</code><br />
<code>#include &lt;<a class="el" href="nvm_8h_source.html">nvm/inc/nvm.h</a>&gt;</code><br />
<code>#include &lt;nvm_cfg.h&gt;</code><br />
<code>#include &quot;<a class="el" href="_m_a_c_c_r_c32___classic___impl_8h_source.html">MACCRC32_Classic_Impl.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="trace_8h_source.html">trace.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="assertions_8h_source.html">assertions.h</a>&quot;</code><br />
</div>
<p><a href="nvm_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="define-members" name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a5ff91b2ac1daaff702f87e2d302e7b42"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="nvm_8c.html#a5ff91b2ac1daaff702f87e2d302e7b42">CRC32_INIT_VALUE</a>&#160;&#160;&#160;((uint32_t)0xFFFFFFFF)</td></tr>
<tr class="separator:a5ff91b2ac1daaff702f87e2d302e7b42"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6b6b332f193824bdc78767f41e4b1323"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="nvm_8c.html#a6b6b332f193824bdc78767f41e4b1323">CRC_PROTECTED</a>&#160;&#160;&#160;(true)</td></tr>
<tr class="separator:a6b6b332f193824bdc78767f41e4b1323"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a921ad9756906f79e6e6db5f1c58cd135"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="nvm_8c.html#a921ad9756906f79e6e6db5f1c58cd135">CRC32_SIZE</a>&#160;&#160;&#160;(sizeof(uint32_t))</td></tr>
<tr class="separator:a921ad9756906f79e6e6db5f1c58cd135"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aef7e53ff92ad9076693432da9040846c"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="nvm_8c.html#aef7e53ff92ad9076693432da9040846c">NVM_TRACE_SIGNATURE</a>&#160;&#160;&#160;(const char *)&quot;[NVM]&quot;</td></tr>
<tr class="separator:aef7e53ff92ad9076693432da9040846c"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="enum-members" name="enum-members"></a>
Enumerations</h2></td></tr>
<tr class="memitem:a04bafd543adbc7833ed3b08b247fffa9"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><b>eDpOpsResult_t</b> { <br />
&#160;&#160;<b>EDPOPSRESULT_OK</b>
, <b>EDPOPSRESULT_ERROR</b>
, <b>EDPOPSRESULT_DEFAULTS_RESTORED</b>
, <b>EDPOPSRESULT_CRC_MISMATCH</b>
, <br />
&#160;&#160;<b>EDPRESULT_MAX</b>
<br />
 }</td></tr>
<tr class="separator:a04bafd543adbc7833ed3b08b247fffa9"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:abba0b3641f1ceea96945631aa0e621ef"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="nvm_8c.html#abba0b3641f1ceea96945631aa0e621ef">Nvm_Init</a> (void)</td></tr>
<tr class="memdesc:abba0b3641f1ceea96945631aa0e621ef"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initializes the Nvm service for use.  <a href="nvm_8c.html#abba0b3641f1ceea96945631aa0e621ef">More...</a><br /></td></tr>
<tr class="separator:abba0b3641f1ceea96945631aa0e621ef"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abb0bcc6b000d26e418dc0b334d1724ac"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="nvm_8c.html#abb0bcc6b000d26e418dc0b334d1724ac">Nvm_Load</a> (void)</td></tr>
<tr class="memdesc:abb0bcc6b000d26e418dc0b334d1724ac"><td class="mdescLeft">&#160;</td><td class="mdescRight">Loads the NVM data from the persistent storage to the RAM mirror.  <a href="nvm_8c.html#abb0bcc6b000d26e418dc0b334d1724ac">More...</a><br /></td></tr>
<tr class="separator:abb0bcc6b000d26e418dc0b334d1724ac"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a646d03a772428cd8d6ec93db8e17f596"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="nvm_8c.html#a646d03a772428cd8d6ec93db8e17f596">Nvm_Store</a> (const bool bForceDefaults)</td></tr>
<tr class="memdesc:a646d03a772428cd8d6ec93db8e17f596"><td class="mdescLeft">&#160;</td><td class="mdescRight">Updates all NVM blocks to the persistent storage using the current state of the RAM mirror.  <a href="nvm_8c.html#a646d03a772428cd8d6ec93db8e17f596">More...</a><br /></td></tr>
<tr class="separator:a646d03a772428cd8d6ec93db8e17f596"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af567ce645d08f7ce9caa18091344ff23"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="nvm_8c.html#af567ce645d08f7ce9caa18091344ff23">Nvm_RestoreBlockDefaults</a> (const uint16_t u16BlockId)</td></tr>
<tr class="memdesc:af567ce645d08f7ce9caa18091344ff23"><td class="mdescLeft">&#160;</td><td class="mdescRight">The functions overwrites the persistent storage for a given block with the ROM default values.  <a href="nvm_8c.html#af567ce645d08f7ce9caa18091344ff23">More...</a><br /></td></tr>
<tr class="separator:af567ce645d08f7ce9caa18091344ff23"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad9189f9ead27b3c1c558c5c7ffe6b583"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="nvm_8c.html#ad9189f9ead27b3c1c558c5c7ffe6b583">Nvm_GetBlockById</a> (uint16_t u16BlockId, void *const pBlockBuffer)</td></tr>
<tr class="memdesc:ad9189f9ead27b3c1c558c5c7ffe6b583"><td class="mdescLeft">&#160;</td><td class="mdescRight">Makes a copy of the stored data for a given NVM block to a user-specified buffer.  <a href="nvm_8c.html#ad9189f9ead27b3c1c558c5c7ffe6b583">More...</a><br /></td></tr>
<tr class="separator:ad9189f9ead27b3c1c558c5c7ffe6b583"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7ab2eb6f64098ab587e2664b7c303f63"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="nvm_8c.html#a7ab2eb6f64098ab587e2664b7c303f63">Nvm_SetBlockById</a> (uint16_t u16BlockId, void *const pBlockBuffer, const bool bStoreImmediately)</td></tr>
<tr class="memdesc:a7ab2eb6f64098ab587e2664b7c303f63"><td class="mdescLeft">&#160;</td><td class="mdescRight">Updates the NVM block data to the persistent storage.  <a href="nvm_8c.html#a7ab2eb6f64098ab587e2664b7c303f63">More...</a><br /></td></tr>
<tr class="separator:a7ab2eb6f64098ab587e2664b7c303f63"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p >NVM service core implementation. </p>
<p >Responsible to handle:</p><ul>
<li>Initial loading of NVM data from the persistent storage.</li>
<li>Block integrity verification.</li>
<li>NVM block access (read/write). </li>
</ul>

<p class="definition">Definition in file <a class="el" href="nvm_8c_source.html">nvm.c</a>.</p>
</div><h2 class="groupheader">Macro Definition Documentation</h2>
<a id="a5ff91b2ac1daaff702f87e2d302e7b42" name="a5ff91b2ac1daaff702f87e2d302e7b42"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5ff91b2ac1daaff702f87e2d302e7b42">&#9670;&nbsp;</a></span>CRC32_INIT_VALUE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CRC32_INIT_VALUE&#160;&#160;&#160;((uint32_t)0xFFFFFFFF)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="nvm_8c_source.html#l00033">33</a> of file <a class="el" href="nvm_8c_source.html">nvm.c</a>.</p>

</div>
</div>
<a id="a6b6b332f193824bdc78767f41e4b1323" name="a6b6b332f193824bdc78767f41e4b1323"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6b6b332f193824bdc78767f41e4b1323">&#9670;&nbsp;</a></span>CRC_PROTECTED</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CRC_PROTECTED&#160;&#160;&#160;(true)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="nvm_8c_source.html#l00034">34</a> of file <a class="el" href="nvm_8c_source.html">nvm.c</a>.</p>

</div>
</div>
<a id="a921ad9756906f79e6e6db5f1c58cd135" name="a921ad9756906f79e6e6db5f1c58cd135"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a921ad9756906f79e6e6db5f1c58cd135">&#9670;&nbsp;</a></span>CRC32_SIZE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CRC32_SIZE&#160;&#160;&#160;(sizeof(uint32_t))</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="nvm_8c_source.html#l00035">35</a> of file <a class="el" href="nvm_8c_source.html">nvm.c</a>.</p>

</div>
</div>
<a id="aef7e53ff92ad9076693432da9040846c" name="aef7e53ff92ad9076693432da9040846c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aef7e53ff92ad9076693432da9040846c">&#9670;&nbsp;</a></span>NVM_TRACE_SIGNATURE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define NVM_TRACE_SIGNATURE&#160;&#160;&#160;(const char *)&quot;[NVM]&quot;</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="nvm_8c_source.html#l00036">36</a> of file <a class="el" href="nvm_8c_source.html">nvm.c</a>.</p>

</div>
</div>
<h2 class="groupheader">Enumeration Type Documentation</h2>
<a id="a04bafd543adbc7833ed3b08b247fffa9" name="a04bafd543adbc7833ed3b08b247fffa9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a04bafd543adbc7833ed3b08b247fffa9">&#9670;&nbsp;</a></span>eDpOpsResult_t</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum eDpOpsResult_t</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="nvm_8c_source.html#l00038">38</a> of file <a class="el" href="nvm_8c_source.html">nvm.c</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="abba0b3641f1ceea96945631aa0e621ef" name="abba0b3641f1ceea96945631aa0e621ef"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abba0b3641f1ceea96945631aa0e621ef">&#9670;&nbsp;</a></span>Nvm_Init()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Nvm_Init </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initializes the Nvm service for use. </p>
<p >The function also takes care to initialize the underlying persistent storage (e.g. FRAM, SD card, etc.) drivers.</p>
<dl class="section note"><dt>Note</dt><dd>Actual loading of data from the storage is not performed by this function. </dd></dl>

<p class="definition">Definition at line <a class="el" href="nvm_8c_source.html#l00060">60</a> of file <a class="el" href="nvm_8c_source.html">nvm.c</a>.</p>

</div>
</div>
<a id="abb0bcc6b000d26e418dc0b334d1724ac" name="abb0bcc6b000d26e418dc0b334d1724ac"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abb0bcc6b000d26e418dc0b334d1724ac">&#9670;&nbsp;</a></span>Nvm_Load()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Nvm_Load </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Loads the NVM data from the persistent storage to the RAM mirror. </p>
<p >The load procedure also performs block CRC checking and replacement with a secondary copy of the data in case of redundant block configuration or with defaults in case the block has only one instance. Another important point here is that the version layout of the Nvm structures is checked and if it doesn't match the hardcoded version of the layout, defaults will be forced for all blocks.</p>
<dl class="section note"><dt>Note</dt><dd>Default data is not replaced in the persistent storage - it is only copied to the NVM cache in RAM. </dd></dl>

<p class="definition">Definition at line <a class="el" href="nvm_8c_source.html#l00108">108</a> of file <a class="el" href="nvm_8c_source.html">nvm.c</a>.</p>

</div>
</div>
<a id="a646d03a772428cd8d6ec93db8e17f596" name="a646d03a772428cd8d6ec93db8e17f596"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a646d03a772428cd8d6ec93db8e17f596">&#9670;&nbsp;</a></span>Nvm_Store()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Nvm_Store </td>
          <td>(</td>
          <td class="paramtype">const bool&#160;</td>
          <td class="paramname"><em>bForceDefaults</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Updates all NVM blocks to the persistent storage using the current state of the RAM mirror. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">bForceDefaults</td><td>You can use here any of the <code>NVMSTORE_*</code> macros to specify whether to force-write default values or not. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="nvm_8c_source.html#l00189">189</a> of file <a class="el" href="nvm_8c_source.html">nvm.c</a>.</p>

</div>
</div>
<a id="af567ce645d08f7ce9caa18091344ff23" name="af567ce645d08f7ce9caa18091344ff23"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af567ce645d08f7ce9caa18091344ff23">&#9670;&nbsp;</a></span>Nvm_RestoreBlockDefaults()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Nvm_RestoreBlockDefaults </td>
          <td>(</td>
          <td class="paramtype">const uint16_t&#160;</td>
          <td class="paramname"><em>u16BlockId</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>The functions overwrites the persistent storage for a given block with the ROM default values. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">u16BlockId</td><td>ID of the NVM block to restore defaults to (as specified in <a class="el" href="nvm__block__ids_8h_source.html">nvm_block_ids.h</a>) </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="nvm_8c_source.html#l00220">220</a> of file <a class="el" href="nvm_8c_source.html">nvm.c</a>.</p>

</div>
</div>
<a id="ad9189f9ead27b3c1c558c5c7ffe6b583" name="ad9189f9ead27b3c1c558c5c7ffe6b583"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad9189f9ead27b3c1c558c5c7ffe6b583">&#9670;&nbsp;</a></span>Nvm_GetBlockById()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Nvm_GetBlockById </td>
          <td>(</td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>u16BlockId</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *const&#160;</td>
          <td class="paramname"><em>pBlockBuffer</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Makes a copy of the stored data for a given NVM block to a user-specified buffer. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">u16BlockId</td><td>ID of the NVM block to read from (as specified in <a class="el" href="nvm__block__ids_8h_source.html">nvm_block_ids.h</a>) </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">pBlockBuffer</td><td>A pointer to a user-provided buffer to receive a copy of the NVM data</td></tr>
  </table>
  </dd>
</dl>
<dl class="section warning"><dt>Warning</dt><dd>You have to check the exact data type of the block referenced by <em>u16BlockId</em> because <a class="el" href="nvm_8h.html#ad9189f9ead27b3c1c558c5c7ffe6b583" title="Makes a copy of the stored data for a given NVM block to a user-specified buffer.">Nvm_GetBlockById()</a> may cause memory corruption. In future versions of this interface, we will have named functions per block so that the compiler can enforce type-safety.</dd></dl>
<p><b>Example:</b> <br  />
The following code reads NVM_BLOCK_I2C_CONFIG into the <em><a class="el" href="structi2c__config__t.html">i2c_config_t</a></em> structure because the NVM block defined in <a class="el" href="nvm__app__types_8h_source.html">nvm_app_types.h</a> uses the same type: </p><div class="fragment"><div class="line">NVM_BLOCK_DEFINE_START(<a class="code hl_struct" href="structi2c__config__t.html">i2c_config_t</a>)</div>
<div class="line">    <a class="code hl_struct" href="structbus__pull__up__state__t.html">bus_pull_up_state_t</a> i2c_pull_up_config[I2C_BUS_MAX];</div>
<div class="line">NVM_BLOCK_DEFINE_END(<a class="code hl_struct" href="structi2c__config__t.html">i2c_config_t</a>)</div>
<div class="ttc" id="astructbus__pull__up__state__t_html"><div class="ttname"><a href="structbus__pull__up__state__t.html">bus_pull_up_state_t</a></div><div class="ttdef"><b>Definition:</b> <a href="nvm__app__types_8h_source.html#l00097">nvm_app_types.h:98</a></div></div>
<div class="ttc" id="astructi2c__config__t_html"><div class="ttname"><a href="structi2c__config__t.html">i2c_config_t</a></div><div class="ttdef"><b>Definition:</b> <a href="nvm__app__types_8h_source.html#l00208">nvm_app_types.h:208</a></div></div>
</div><!-- fragment --><p ><span class="emoji">&#x2139;</span> As a rule of thumb, you can <em>blockType</em> provided as a parameter to <code>NVM_BLOCK_DEFINE_START(blockType)</code> as the type for reading and writing NVM block data.</p>
<div class="fragment"><div class="line"><a class="code hl_struct" href="structi2c__config__t.html">i2c_config_t</a> i2c_config;</div>
<div class="line"><a class="code hl_function" href="nvm_8h.html#ad9189f9ead27b3c1c558c5c7ffe6b583">Nvm_GetBlockById</a>(NVM_BLOCK_I2C_CONFIG, &amp;i2c_config);</div>
<div class="ttc" id="anvm_8h_html_ad9189f9ead27b3c1c558c5c7ffe6b583"><div class="ttname"><a href="nvm_8h.html#ad9189f9ead27b3c1c558c5c7ffe6b583">Nvm_GetBlockById</a></div><div class="ttdeci">void Nvm_GetBlockById(uint16_t u16BlockId, void *const pBlockBuffer)</div><div class="ttdoc">Makes a copy of the stored data for a given NVM block to a user-specified buffer.</div><div class="ttdef"><b>Definition:</b> <a href="nvm_8c_source.html#l00243">nvm.c:243</a></div></div>
</div><!-- fragment --> 
<p class="definition">Definition at line <a class="el" href="nvm_8c_source.html#l00243">243</a> of file <a class="el" href="nvm_8c_source.html">nvm.c</a>.</p>

</div>
</div>
<a id="a7ab2eb6f64098ab587e2664b7c303f63" name="a7ab2eb6f64098ab587e2664b7c303f63"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7ab2eb6f64098ab587e2664b7c303f63">&#9670;&nbsp;</a></span>Nvm_SetBlockById()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Nvm_SetBlockById </td>
          <td>(</td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>u16BlockId</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *const&#160;</td>
          <td class="paramname"><em>pBlockBuffer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const bool&#160;</td>
          <td class="paramname"><em>bStoreImmediately</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Updates the NVM block data to the persistent storage. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">u16BlockId</td><td>ID of the NVM block to write to (as specified in <a class="el" href="nvm__block__ids_8h_source.html">nvm_block_ids.h</a>) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">pBlockBuffer</td><td>A pointer to the user block data (<span class="emoji">&#x2757;</span> the size of this buffer must match the actual size of the block) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">bStoreImmediately</td><td>You can put here any of the <code>NVMSETBLOCK_STORE_*</code> macros to specify how the data shall be written to the NVM. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="nvm_8c_source.html#l00255">255</a> of file <a class="el" href="nvm_8c_source.html">nvm.c</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.9.5-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_e2c83a6801e015e427e1c55223a130e1.html">espf</a></li><li class="navelem"><a class="el" href="dir_99f3dafb56e7a0be84da390df3a0ec4d.html">core</a></li><li class="navelem"><a class="el" href="dir_5013bdea625176bf2964ef0fdf345617.html">services</a></li><li class="navelem"><a class="el" href="dir_e2cccf14a43ff729055137b36d3d5a54.html">nvm</a></li><li class="navelem"><a class="el" href="dir_81ab17d897f0e09884e4011f25eec6dd.html">src</a></li><li class="navelem"><a class="el" href="nvm_8c.html">nvm.c</a></li>
    <li class="footer">Generated by Doxygen 1.9.4 </li>
  </ul>
</div>
</body>
</html>
