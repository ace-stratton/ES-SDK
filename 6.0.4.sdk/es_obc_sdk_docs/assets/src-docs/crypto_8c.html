<!-- HTML header for doxygen 1.9.5-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="$langISO">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.4"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>EnduroSat On-Board Computer SDK Documentation: /builds/sw-platform-es/modules/on-boardcomputer/stm32f/obc-stdpf-hw-1.x/espf/core/services/crypto/src/crypto.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
$darkmode
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><a href="../../index.html"><img alt="Logo" src="EnduroSat_horLogo_symbol@2x-min.png"/></a></td>
  <td id="projectalign">
   <div id="projectname">EnduroSat On-Board Computer SDK Documentation
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.4 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('crypto_8c.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle"><div class="title">crypto.c File Reference<div class="ingroups"><a class="el" href="group___services.html">Services</a> &raquo; <a class="el" href="group__crypto.html">Cryptography</a></div></div></div>
</div><!--header-->
<div class="contents">

<p>Basic cryptography services for files relying on the STM32 Cryptographic library.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;stddef.h&gt;</code><br />
<code>#include &lt;string.h&gt;</code><br />
<code>#include &lt;math.h&gt;</code><br />
<code>#include &quot;<a class="el" href="crypto_8h_source.html">crypto.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="es__cdef_8h_source.html">es_cdef.h</a>&quot;</code><br />
<code>#include &quot;cmsis_os2.h&quot;</code><br />
<code>#include &quot;<a class="el" href="es__exeh_8h_source.html">es_exeh.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="_task_monitor_8h_source.html">TaskMonitor.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="trace_8h_source.html">trace.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="_sd_mngr_8h_source.html">SdMngr.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="crypto__cfg_8h_source.html">crypto_cfg.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="csq__algo_8h_source.html">csq_algo.h</a>&quot;</code><br />
<code>#include &quot;cmox_crypto.h&quot;</code><br />
<code>#include &quot;<a class="el" href="module__id_8h_source.html">module_id.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="rng_8h_source.html">rng.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="timer_8h_source.html">timer.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="nvm_8h_source.html">nvm.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="assertions_8h_source.html">assertions.h</a>&quot;</code><br />
</div>
<p><a href="crypto_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structcipher__entry__t.html">cipher_entry_t</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Configuration map cipher entry.  <a href="structcipher__entry__t.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structcrypto__file__req__t.html">crypto_file_req_t</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">The structure defines the parameters of a request to perform on a user-specified file.  <a href="structcrypto__file__req__t.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structcrypto__runtime__context__t.html">crypto_runtime_context_t</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Crypto service runtime context structure.  <a href="structcrypto__runtime__context__t.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="define-members" name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a010eb3b112e01e79f7c23a2c63ca7237"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#a010eb3b112e01e79f7c23a2c63ca7237">EXEH_CURRENT_MODULE_ID</a>&#160;&#160;&#160;eEXEHModuleID_CRYPTO</td></tr>
<tr class="memdesc:a010eb3b112e01e79f7c23a2c63ca7237"><td class="mdescLeft">&#160;</td><td class="mdescRight">Module ID used for this file to report error events in EXEH.  <a href="crypto_8c.html#a010eb3b112e01e79f7c23a2c63ca7237">More...</a><br /></td></tr>
<tr class="separator:a010eb3b112e01e79f7c23a2c63ca7237"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a14d36260412b53d3e4e3b1f434cde57a"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#a14d36260412b53d3e4e3b1f434cde57a">UNBLOCK_CRYPTO_TASK</a>&#160;&#160;&#160;(0x10)</td></tr>
<tr class="memdesc:a14d36260412b53d3e4e3b1f434cde57a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Flag value used with osThreadFlagsWait() to unblock main task in case a processing event.  <a href="crypto_8c.html#a14d36260412b53d3e4e3b1f434cde57a">More...</a><br /></td></tr>
<tr class="separator:a14d36260412b53d3e4e3b1f434cde57a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae288ddbc3e28317cad52569beb5e8de6"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#ae288ddbc3e28317cad52569beb5e8de6">ENTROPY_SIZE_BYTES</a>&#160;&#160;&#160;(32U)</td></tr>
<tr class="memdesc:ae288ddbc3e28317cad52569beb5e8de6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Number of bytes reserved for the RNG entropy seed.  <a href="crypto_8c.html#ae288ddbc3e28317cad52569beb5e8de6">More...</a><br /></td></tr>
<tr class="separator:ae288ddbc3e28317cad52569beb5e8de6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad0678d7598078704533305ff431020be"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#ad0678d7598078704533305ff431020be">NONCE_SIZE_BYTES</a>&#160;&#160;&#160;(16U)</td></tr>
<tr class="memdesc:ad0678d7598078704533305ff431020be"><td class="mdescLeft">&#160;</td><td class="mdescRight">Number of bytes to use for the nonce value generated initially for seeding DRBG library.  <a href="crypto_8c.html#ad0678d7598078704533305ff431020be">More...</a><br /></td></tr>
<tr class="separator:ad0678d7598078704533305ff431020be"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a85fa5270b24b1f60562799e440e5a5bb"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#a85fa5270b24b1f60562799e440e5a5bb">CIPHER_ALGO_NAME</a>&#160;&#160;&#160;&quot;AES_256_GCM&quot;</td></tr>
<tr class="memdesc:a85fa5270b24b1f60562799e440e5a5bb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Name of the cipher algo used by this crypto service which will be provided as part of the <a class="el" href="structencrypted__data__hdr__t.html" title="EnduroSat encrypted data header format.">encrypted_data_hdr_t</a> block in the encrypted file.  <a href="crypto_8c.html#a85fa5270b24b1f60562799e440e5a5bb">More...</a><br /></td></tr>
<tr class="separator:a85fa5270b24b1f60562799e440e5a5bb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0fda8a9df281605610a8be897d5c2e0c"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#a0fda8a9df281605610a8be897d5c2e0c">DATA_HDR_MAJOR</a>&#160;&#160;&#160;(0U)</td></tr>
<tr class="memdesc:a0fda8a9df281605610a8be897d5c2e0c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Major version of the <a class="el" href="structencrypted__data__hdr__t.html" title="EnduroSat encrypted data header format.">encrypted_data_hdr_t</a> block (increment when you make breaking changes to the header block)  <a href="crypto_8c.html#a0fda8a9df281605610a8be897d5c2e0c">More...</a><br /></td></tr>
<tr class="separator:a0fda8a9df281605610a8be897d5c2e0c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a62bcf47e4afad565136c344d668a9021"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#a62bcf47e4afad565136c344d668a9021">DATA_HDR_MINOR</a>&#160;&#160;&#160;(1U)</td></tr>
<tr class="memdesc:a62bcf47e4afad565136c344d668a9021"><td class="mdescLeft">&#160;</td><td class="mdescRight">Minor version of the <a class="el" href="structencrypted__data__hdr__t.html" title="EnduroSat encrypted data header format.">encrypted_data_hdr_t</a> block (increment when you make non-breaking changes to the header block)  <a href="crypto_8c.html#a62bcf47e4afad565136c344d668a9021">More...</a><br /></td></tr>
<tr class="separator:a62bcf47e4afad565136c344d668a9021"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="typedef-members" name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:a168c9d83a8101193a548b4b514987c7c"><td class="memItemLeft" align="right" valign="top">typedef <a class="el" href="crypto_8h.html#ac2373ddb406a15dd452fcf61ab8ada10">crypto_api_res_t</a>(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#a168c9d83a8101193a548b4b514987c7c">p_stream_stage_pipeline_t</a>) (<a class="el" href="structcrypto__stream__hnd__t.html">crypto_stream_hnd_t</a> *const p_stream_hnd, uint8_t *p_read_buf, uint8_t *const p_output_buf, const uint32_t bytes_to_read, uint32_t *const p_bytes_read)</td></tr>
<tr class="memdesc:a168c9d83a8101193a548b4b514987c7c"><td class="mdescLeft">&#160;</td><td class="mdescRight">A function pointer to a stream pipeline handler.  <a href="crypto_8c.html#a168c9d83a8101193a548b4b514987c7c">More...</a><br /></td></tr>
<tr class="separator:a168c9d83a8101193a548b4b514987c7c"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ac3bf2ce3168e1c3d238b103cac3bb639"><td class="memItemLeft" align="right" valign="top">STATIC bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#ac3bf2ce3168e1c3d238b103cac3bb639">is_key_valid</a> (const uint8_t *const p_key, const uint8_t key_size)</td></tr>
<tr class="memdesc:ac3bf2ce3168e1c3d238b103cac3bb639"><td class="mdescLeft">&#160;</td><td class="mdescRight">Checks if the provided key is valid (i.e. being non-zero)  <a href="crypto_8c.html#ac3bf2ce3168e1c3d238b103cac3bb639">More...</a><br /></td></tr>
<tr class="separator:ac3bf2ce3168e1c3d238b103cac3bb639"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2794b2ff999e33a6ace61e18999a70fc"><td class="memItemLeft" align="right" valign="top">STATIC void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#a2794b2ff999e33a6ace61e18999a70fc">crypto_task</a> (void *p_task_arg)</td></tr>
<tr class="memdesc:a2794b2ff999e33a6ace61e18999a70fc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Main Crypto service OS task function.  <a href="crypto_8c.html#a2794b2ff999e33a6ace61e18999a70fc">More...</a><br /></td></tr>
<tr class="separator:a2794b2ff999e33a6ace61e18999a70fc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6236428545780735c02e4b04136ee1cd"><td class="memItemLeft" align="right" valign="top">STATIC void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#a6236428545780735c02e4b04136ee1cd">safe_copy_str</a> (char *const p_dst_str, const char *const p_src_str, const size_t dst_size)</td></tr>
<tr class="memdesc:a6236428545780735c02e4b04136ee1cd"><td class="mdescLeft">&#160;</td><td class="mdescRight">The function makes a copy of a null-terminated string to a buffer ensuring the buffer is null terminated even if the copy was partial.  <a href="crypto_8c.html#a6236428545780735c02e4b04136ee1cd">More...</a><br /></td></tr>
<tr class="separator:a6236428545780735c02e4b04136ee1cd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a84d06036031a531e7cecc323d05b2164"><td class="memItemLeft" align="right" valign="top">STATIC <a class="el" href="crypto_8h.html#a3857531fa232576dce194dd28b8ceba1">crypto_req_status_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#a84d06036031a531e7cecc323d05b2164">queue_cipher_op</a> (const char *const p_src_file_name, const char *const p_target_file_name, const <a class="el" href="crypto_8h.html#a629f8bc4af94faad8768be934305d919">p_crypto_notif</a> p_user_cbk, <a class="el" href="crypto_8h.html#a43bf1ce3753a89393539d1c76255d47a">cipher_alg_type_t</a> alg_type)</td></tr>
<tr class="memdesc:a84d06036031a531e7cecc323d05b2164"><td class="mdescLeft">&#160;</td><td class="mdescRight">Queues a cipher operation on a file for execution.  <a href="crypto_8c.html#a84d06036031a531e7cecc323d05b2164">More...</a><br /></td></tr>
<tr class="separator:a84d06036031a531e7cecc323d05b2164"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae36476fd4ae5980ac67aa8acc1443f84"><td class="memItemLeft" align="right" valign="top">STATIC void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#ae36476fd4ae5980ac67aa8acc1443f84">csq_get_slot_data</a> (const uint32_t slot_idx, void *const p_data_buf)</td></tr>
<tr class="memdesc:ae36476fd4ae5980ac67aa8acc1443f84"><td class="mdescLeft">&#160;</td><td class="mdescRight">User set function for CSQ_ALGO library.  <a href="crypto_8c.html#ae36476fd4ae5980ac67aa8acc1443f84">More...</a><br /></td></tr>
<tr class="separator:ae36476fd4ae5980ac67aa8acc1443f84"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7a76ae397ee8436ab83da23730a31692"><td class="memItemLeft" align="right" valign="top">STATIC <a class="el" href="crypto_8h.html#ac2373ddb406a15dd452fcf61ab8ada10">crypto_api_res_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#a7a76ae397ee8436ab83da23730a31692">crypt_decrypt_file</a> (const char *const p_src_file_name, const char *const p_target_file_name, const <a class="el" href="crypto_8h.html#a43bf1ce3753a89393539d1c76255d47a">cipher_alg_type_t</a> impl_type)</td></tr>
<tr class="memdesc:a7a76ae397ee8436ab83da23730a31692"><td class="mdescLeft">&#160;</td><td class="mdescRight">Performs a specified cipher algorithm on a file producing a new file with a given name.  <a href="crypto_8c.html#a7a76ae397ee8436ab83da23730a31692">More...</a><br /></td></tr>
<tr class="separator:a7a76ae397ee8436ab83da23730a31692"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a878b66d27359fac280d277f220b6444f"><td class="memItemLeft" align="right" valign="top">STATIC void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#a878b66d27359fac280d277f220b6444f">generate_iv</a> (uint8_t *const p_iv, const uint32_t iv_size)</td></tr>
<tr class="memdesc:a878b66d27359fac280d277f220b6444f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Performs a one-time generation of a random init vector for encryption.  <a href="crypto_8c.html#a878b66d27359fac280d277f220b6444f">More...</a><br /></td></tr>
<tr class="separator:a878b66d27359fac280d277f220b6444f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a59def54a84b12a39a8be117bf6f2634a"><td class="memItemLeft" align="right" valign="top">STATIC <a class="el" href="crypto_8h.html#ac2373ddb406a15dd452fcf61ab8ada10">crypto_api_res_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#a59def54a84b12a39a8be117bf6f2634a">prep_file_for_stream_encr</a> (<a class="el" href="structcrypto__stream__hnd__t.html">crypto_stream_hnd_t</a> *const p_stream_hnd)</td></tr>
<tr class="memdesc:a59def54a84b12a39a8be117bf6f2634a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Refer to <a class="el" href="crypto_8c.html#a168c9d83a8101193a548b4b514987c7c">p_stream_stage_pipeline_t</a> function pointer type for a description of all parameters here.  <a href="crypto_8c.html#a59def54a84b12a39a8be117bf6f2634a">More...</a><br /></td></tr>
<tr class="separator:a59def54a84b12a39a8be117bf6f2634a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aae1229e72ffe3c4866bf84fe60f5f0fd"><td class="memItemLeft" align="right" valign="top">STATIC <a class="el" href="crypto_8h.html#ac2373ddb406a15dd452fcf61ab8ada10">crypto_api_res_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#aae1229e72ffe3c4866bf84fe60f5f0fd">prep_file_for_stream_decr</a> (<a class="el" href="structcrypto__stream__hnd__t.html">crypto_stream_hnd_t</a> *const p_stream_hnd)</td></tr>
<tr class="memdesc:aae1229e72ffe3c4866bf84fe60f5f0fd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Refer to <a class="el" href="crypto_8c.html#a168c9d83a8101193a548b4b514987c7c">p_stream_stage_pipeline_t</a> function pointer type for a description of all parameters here.  <a href="crypto_8c.html#aae1229e72ffe3c4866bf84fe60f5f0fd">More...</a><br /></td></tr>
<tr class="separator:aae1229e72ffe3c4866bf84fe60f5f0fd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a36802e5d89a9c008cbd8edf3f3c26dc7"><td class="memItemLeft" align="right" valign="top">STATIC <a class="el" href="crypto_8h.html#ac2373ddb406a15dd452fcf61ab8ada10">crypto_api_res_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#a36802e5d89a9c008cbd8edf3f3c26dc7">read_from_buf</a> (<a class="el" href="structcrypto__stream__hnd__t.html">crypto_stream_hnd_t</a> *const p_stream_hnd, uint8_t *const p_buf, const uint32_t buf_size, uint8_t *p_read_buf, uint8_t *const p_output_buf, const uint32_t bytes_to_read, uint32_t *const p_bytes_read)</td></tr>
<tr class="memdesc:a36802e5d89a9c008cbd8edf3f3c26dc7"><td class="mdescLeft">&#160;</td><td class="mdescRight">A helper function to read a data in a streaming manner from a given buffer in RAM.  <a href="crypto_8c.html#a36802e5d89a9c008cbd8edf3f3c26dc7">More...</a><br /></td></tr>
<tr class="separator:a36802e5d89a9c008cbd8edf3f3c26dc7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6945a6149e9d71456052c190c617599d"><td class="memItemLeft" align="right" valign="top">STATIC <a class="el" href="crypto_8h.html#ac2373ddb406a15dd452fcf61ab8ada10">crypto_api_res_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#a6945a6149e9d71456052c190c617599d">read_from_header</a> (<a class="el" href="structcrypto__stream__hnd__t.html">crypto_stream_hnd_t</a> *const p_stream_hnd, uint8_t *p_read_buf, uint8_t *const p_output_buf, const uint32_t bytes_to_read, uint32_t *const p_bytes_read)</td></tr>
<tr class="memdesc:a6945a6149e9d71456052c190c617599d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Refer to <a class="el" href="crypto_8c.html#a168c9d83a8101193a548b4b514987c7c">p_stream_stage_pipeline_t</a> function pointer type for a description of all parameters here.  <a href="crypto_8c.html#a6945a6149e9d71456052c190c617599d">More...</a><br /></td></tr>
<tr class="separator:a6945a6149e9d71456052c190c617599d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1763f5163b0a7cec714226b4f418fbab"><td class="memItemLeft" align="right" valign="top">STATIC <a class="el" href="crypto_8h.html#ac2373ddb406a15dd452fcf61ab8ada10">crypto_api_res_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#a1763f5163b0a7cec714226b4f418fbab">read_from_temp_buf</a> (<a class="el" href="structcrypto__stream__hnd__t.html">crypto_stream_hnd_t</a> *const p_stream_hnd, uint8_t *p_read_buf, uint8_t *const p_output_buf, const uint32_t bytes_to_read, uint32_t *const p_bytes_read)</td></tr>
<tr class="separator:a1763f5163b0a7cec714226b4f418fbab"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afc4f807d6701c6b7a2fe29685614be59"><td class="memItemLeft" align="right" valign="top">STATIC <a class="el" href="crypto_8h.html#ac2373ddb406a15dd452fcf61ab8ada10">crypto_api_res_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#afc4f807d6701c6b7a2fe29685614be59">read_from_footer</a> (<a class="el" href="structcrypto__stream__hnd__t.html">crypto_stream_hnd_t</a> *const p_stream_hnd, uint8_t *p_read_buf, uint8_t *const p_output_buf, const uint32_t bytes_to_read, uint32_t *const p_bytes_read)</td></tr>
<tr class="memdesc:afc4f807d6701c6b7a2fe29685614be59"><td class="mdescLeft">&#160;</td><td class="mdescRight">Refer to <a class="el" href="crypto_8c.html#a168c9d83a8101193a548b4b514987c7c">p_stream_stage_pipeline_t</a> function pointer type for a description of all parameters here.  <a href="crypto_8c.html#afc4f807d6701c6b7a2fe29685614be59">More...</a><br /></td></tr>
<tr class="separator:afc4f807d6701c6b7a2fe29685614be59"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0d805a0841a200cc48d42efab899e172"><td class="memItemLeft" align="right" valign="top">STATIC <a class="el" href="crypto_8h.html#ac2373ddb406a15dd452fcf61ab8ada10">crypto_api_res_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#a0d805a0841a200cc48d42efab899e172">prepare_footer</a> (<a class="el" href="structcrypto__stream__hnd__t.html">crypto_stream_hnd_t</a> *const p_stream_hnd, uint8_t *p_read_buf, uint8_t *const p_output_buf, const uint32_t bytes_to_read, uint32_t *const p_bytes_read)</td></tr>
<tr class="memdesc:a0d805a0841a200cc48d42efab899e172"><td class="mdescLeft">&#160;</td><td class="mdescRight">Refer to <a class="el" href="crypto_8c.html#a168c9d83a8101193a548b4b514987c7c">p_stream_stage_pipeline_t</a> function pointer type for a description of all parameters here.  <a href="crypto_8c.html#a0d805a0841a200cc48d42efab899e172">More...</a><br /></td></tr>
<tr class="separator:a0d805a0841a200cc48d42efab899e172"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ada9232ae8800c2c5351e062f76d63afd"><td class="memItemLeft" align="right" valign="top">STATIC <a class="el" href="crypto_8h.html#ac2373ddb406a15dd452fcf61ab8ada10">crypto_api_res_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#ada9232ae8800c2c5351e062f76d63afd">verify_footer</a> (<a class="el" href="structcrypto__stream__hnd__t.html">crypto_stream_hnd_t</a> *const p_stream_hnd, uint8_t *p_read_buf, uint8_t *const p_output_buf, const uint32_t bytes_to_read, uint32_t *const p_bytes_read)</td></tr>
<tr class="memdesc:ada9232ae8800c2c5351e062f76d63afd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Refer to <a class="el" href="crypto_8c.html#a168c9d83a8101193a548b4b514987c7c">p_stream_stage_pipeline_t</a> function pointer type for a description of all parameters here.  <a href="crypto_8c.html#ada9232ae8800c2c5351e062f76d63afd">More...</a><br /></td></tr>
<tr class="separator:ada9232ae8800c2c5351e062f76d63afd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aca2df3e1b39c604531737ba11b3d892f"><td class="memItemLeft" align="right" valign="top">STATIC <a class="el" href="crypto_8h.html#ac2373ddb406a15dd452fcf61ab8ada10">crypto_api_res_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#aca2df3e1b39c604531737ba11b3d892f">read_chunk_and_process</a> (<a class="el" href="structcrypto__stream__hnd__t.html">crypto_stream_hnd_t</a> *const p_stream_hnd, uint8_t *p_read_buf, uint8_t *const p_output_buf, const uint32_t bytes_to_read, uint32_t *const p_bytes_read)</td></tr>
<tr class="memdesc:aca2df3e1b39c604531737ba11b3d892f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Refer to <a class="el" href="crypto_8c.html#a168c9d83a8101193a548b4b514987c7c">p_stream_stage_pipeline_t</a> function pointer type for a description of all parameters here.  <a href="crypto_8c.html#aca2df3e1b39c604531737ba11b3d892f">More...</a><br /></td></tr>
<tr class="separator:aca2df3e1b39c604531737ba11b3d892f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab34aa06d7449193e45b084cbc2ffb7c8"><td class="memItemLeft" align="right" valign="top">STATIC <a class="el" href="crypto_8h.html#ac2373ddb406a15dd452fcf61ab8ada10">crypto_api_res_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#ab34aa06d7449193e45b084cbc2ffb7c8">prepare_temp_buf</a> (<a class="el" href="structcrypto__stream__hnd__t.html">crypto_stream_hnd_t</a> *const p_stream_hnd, uint8_t *p_read_buf, uint8_t *const p_output_buf, const uint32_t bytes_to_read, uint32_t *const p_bytes_read)</td></tr>
<tr class="separator:ab34aa06d7449193e45b084cbc2ffb7c8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a85ea4ad34e77eb6e093b4c01656807df"><td class="memItemLeft" align="right" valign="top">STATIC <a class="el" href="crypto_8h.html#ac2373ddb406a15dd452fcf61ab8ada10">crypto_api_res_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#a85ea4ad34e77eb6e093b4c01656807df">read_from_file</a> (<a class="el" href="structcrypto__stream__hnd__t.html">crypto_stream_hnd_t</a> *const p_stream_hnd, uint8_t *p_read_buf, uint8_t *const p_output_buf, const uint32_t bytes_to_read, uint32_t *const p_bytes_read)</td></tr>
<tr class="separator:a85ea4ad34e77eb6e093b4c01656807df"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1b4d840d55407fad7c0b34d2cd1da6b9"><td class="memItemLeft" align="right" valign="top">STATIC void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#a1b4d840d55407fad7c0b34d2cd1da6b9">set_next_stage</a> (<a class="el" href="structcrypto__stream__hnd__t.html">crypto_stream_hnd_t</a> *const p_stream_hnd, <a class="el" href="crypto_8c.html#a168c9d83a8101193a548b4b514987c7c">p_stream_stage_pipeline_t</a> const p_next_stage)</td></tr>
<tr class="separator:a1b4d840d55407fad7c0b34d2cd1da6b9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2a507bfc6ed34cbbf6c7672d388cbbd2"><td class="memItemLeft" align="right" valign="top"><a id="a2a507bfc6ed34cbbf6c7672d388cbbd2" name="a2a507bfc6ed34cbbf6c7672d388cbbd2"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>osMutexDef</b> (crypto_lock)</td></tr>
<tr class="memdesc:a2a507bfc6ed34cbbf6c7672d388cbbd2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Mutex to use for synchronizing access to the component structures. <br /></td></tr>
<tr class="separator:a2a507bfc6ed34cbbf6c7672d388cbbd2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2ca66594182ad6110b531bee690b1c56"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#a2ca66594182ad6110b531bee690b1c56">crypto_init</a> (void)</td></tr>
<tr class="memdesc:a2ca66594182ad6110b531bee690b1c56"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialises the service memory and prepares it for operation.  <a href="crypto_8c.html#a2ca66594182ad6110b531bee690b1c56">More...</a><br /></td></tr>
<tr class="separator:a2ca66594182ad6110b531bee690b1c56"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a77ae468abdc9ed68f924dcfbefe723f1"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#a77ae468abdc9ed68f924dcfbefe723f1">crypto_start</a> (void)</td></tr>
<tr class="memdesc:a77ae468abdc9ed68f924dcfbefe723f1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Spawns the service OS-tasks and enables the service API.  <a href="crypto_8c.html#a77ae468abdc9ed68f924dcfbefe723f1">More...</a><br /></td></tr>
<tr class="separator:a77ae468abdc9ed68f924dcfbefe723f1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adce817ec6205757405b5777ebf952590"><td class="memItemLeft" align="right" valign="top"><a class="el" href="crypto_8h.html#a3857531fa232576dce194dd28b8ceba1">crypto_req_status_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#adce817ec6205757405b5777ebf952590">crypto_std_encrypt_file</a> (const char *const p_src_file_name, const char *const p_target_file_name, const <a class="el" href="crypto_8h.html#a629f8bc4af94faad8768be934305d919">p_crypto_notif</a> p_user_cbk)</td></tr>
<tr class="memdesc:adce817ec6205757405b5777ebf952590"><td class="mdescLeft">&#160;</td><td class="mdescRight">The operation queues a user-specified file for encryption using the default (pre-configured) cipher algorithm.  <a href="crypto_8c.html#adce817ec6205757405b5777ebf952590">More...</a><br /></td></tr>
<tr class="separator:adce817ec6205757405b5777ebf952590"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a71ae81007dcc0de5af06a2d191e3f7b2"><td class="memItemLeft" align="right" valign="top"><a class="el" href="crypto_8h.html#a3857531fa232576dce194dd28b8ceba1">crypto_req_status_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#a71ae81007dcc0de5af06a2d191e3f7b2">crypto_std_decrypt_file</a> (const char *const p_src_file_name, const char *const p_target_file_name, const <a class="el" href="crypto_8h.html#a629f8bc4af94faad8768be934305d919">p_crypto_notif</a> p_user_cbk)</td></tr>
<tr class="memdesc:a71ae81007dcc0de5af06a2d191e3f7b2"><td class="mdescLeft">&#160;</td><td class="mdescRight">The operation queues a user-specified file for decryption using the default (pre-configured) cipher algorithm.  <a href="crypto_8c.html#a71ae81007dcc0de5af06a2d191e3f7b2">More...</a><br /></td></tr>
<tr class="separator:a71ae81007dcc0de5af06a2d191e3f7b2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aca7afcf337d284c83847da9c8c3ed1fe"><td class="memItemLeft" align="right" valign="top"><a class="el" href="crypto_8h.html#a8bf9a47ecfcca260eea93f9aa5de1fe7">crypto_key_upd_status_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#aca7afcf337d284c83847da9c8c3ed1fe">crypto_update_key_store</a> (const uint8_t *const p_key, const uint8_t key_size)</td></tr>
<tr class="memdesc:aca7afcf337d284c83847da9c8c3ed1fe"><td class="mdescLeft">&#160;</td><td class="mdescRight">Updates the symmetric encryption key to the currently configured key store.  <a href="crypto_8c.html#aca7afcf337d284c83847da9c8c3ed1fe">More...</a><br /></td></tr>
<tr class="separator:aca7afcf337d284c83847da9c8c3ed1fe"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aee4c21424d6d701cf8dd4b33f35bad91"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#aee4c21424d6d701cf8dd4b33f35bad91">crypto_abort</a> (const <a class="el" href="crypto_8h.html#a1718915519b2668786d8cc0719d1f447">crypto_abort_op_t</a> op_type)</td></tr>
<tr class="memdesc:aee4c21424d6d701cf8dd4b33f35bad91"><td class="mdescLeft">&#160;</td><td class="mdescRight">Aborts one or more cipher operations.  <a href="crypto_8c.html#aee4c21424d6d701cf8dd4b33f35bad91">More...</a><br /></td></tr>
<tr class="separator:aee4c21424d6d701cf8dd4b33f35bad91"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae0f55316df548f92944a39aeea11f21f"><td class="memItemLeft" align="right" valign="top"><a class="el" href="crypto_8h.html#ac2373ddb406a15dd452fcf61ab8ada10">crypto_api_res_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#ae0f55316df548f92944a39aeea11f21f">crypto_stream_open_always</a> (<a class="el" href="structcrypto__stream__hnd__t.html">crypto_stream_hnd_t</a> *const p_stream_hnd, const char *const p_src_file_name, const <a class="el" href="crypto_8h.html#a43bf1ce3753a89393539d1c76255d47a">cipher_alg_type_t</a> impl_type)</td></tr>
<tr class="memdesc:ae0f55316df548f92944a39aeea11f21f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Opens a crypto stream from a file.  <a href="crypto_8c.html#ae0f55316df548f92944a39aeea11f21f">More...</a><br /></td></tr>
<tr class="separator:ae0f55316df548f92944a39aeea11f21f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2b879d39e255689c68c0c396b4e88a51"><td class="memItemLeft" align="right" valign="top"><a class="el" href="crypto_8h.html#ac2373ddb406a15dd452fcf61ab8ada10">crypto_api_res_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#a2b879d39e255689c68c0c396b4e88a51">crypto_stream_open</a> (<a class="el" href="structcrypto__stream__hnd__t.html">crypto_stream_hnd_t</a> *const p_stream_hnd, const char *const p_src_file_name, const <a class="el" href="crypto_8h.html#a43bf1ce3753a89393539d1c76255d47a">cipher_alg_type_t</a> impl_type)</td></tr>
<tr class="memdesc:a2b879d39e255689c68c0c396b4e88a51"><td class="mdescLeft">&#160;</td><td class="mdescRight">Opens a crypto stream from a file.  <a href="crypto_8c.html#a2b879d39e255689c68c0c396b4e88a51">More...</a><br /></td></tr>
<tr class="separator:a2b879d39e255689c68c0c396b4e88a51"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adb125e25edeaf7abe00dd06fe4732d68"><td class="memItemLeft" align="right" valign="top"><a class="el" href="crypto_8h.html#ac2373ddb406a15dd452fcf61ab8ada10">crypto_api_res_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#adb125e25edeaf7abe00dd06fe4732d68">crypto_stream_read</a> (<a class="el" href="structcrypto__stream__hnd__t.html">crypto_stream_hnd_t</a> *const p_stream_hnd, uint8_t *const p_output_buf, const uint32_t output_buf_size, uint32_t *const p_bytes_read)</td></tr>
<tr class="memdesc:adb125e25edeaf7abe00dd06fe4732d68"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reads data from an opened stream using the associated cipher algorithm.  <a href="crypto_8c.html#adb125e25edeaf7abe00dd06fe4732d68">More...</a><br /></td></tr>
<tr class="separator:adb125e25edeaf7abe00dd06fe4732d68"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abbf4c36f9b9564fdc5538dfa9e0328c7"><td class="memItemLeft" align="right" valign="top"><a class="el" href="crypto_8h.html#ac2373ddb406a15dd452fcf61ab8ada10">crypto_api_res_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#abbf4c36f9b9564fdc5538dfa9e0328c7">crypto_stream_get_size</a> (<a class="el" href="structcrypto__stream__hnd__t.html">crypto_stream_hnd_t</a> *const p_stream_hnd, uint32_t *const p_stream_size)</td></tr>
<tr class="memdesc:abbf4c36f9b9564fdc5538dfa9e0328c7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns the final size of the associated cipher stream in bytes.  <a href="crypto_8c.html#abbf4c36f9b9564fdc5538dfa9e0328c7">More...</a><br /></td></tr>
<tr class="separator:abbf4c36f9b9564fdc5538dfa9e0328c7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a666d95b9c795fdc51f1c25af61ae6e43"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#a666d95b9c795fdc51f1c25af61ae6e43">crypto_stream_close</a> (<a class="el" href="structcrypto__stream__hnd__t.html">crypto_stream_hnd_t</a> *const p_stream_hnd)</td></tr>
<tr class="memdesc:a666d95b9c795fdc51f1c25af61ae6e43"><td class="mdescLeft">&#160;</td><td class="mdescRight">Closes an active stream and frees all resources.  <a href="crypto_8c.html#a666d95b9c795fdc51f1c25af61ae6e43">More...</a><br /></td></tr>
<tr class="separator:a666d95b9c795fdc51f1c25af61ae6e43"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="var-members" name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a489754f4b059d9f404f6bfe72f4a1e30"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="structcipher__entry__t.html">cipher_entry_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypto_8c.html#a489754f4b059d9f404f6bfe72f4a1e30">cipher_alg_map</a> [OP_CMOX_MAX]</td></tr>
<tr class="memdesc:a489754f4b059d9f404f6bfe72f4a1e30"><td class="mdescLeft">&#160;</td><td class="mdescRight">Cipher algo map.  <a href="crypto_8c.html#a489754f4b059d9f404f6bfe72f4a1e30">More...</a><br /></td></tr>
<tr class="separator:a489754f4b059d9f404f6bfe72f4a1e30"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p >Basic cryptography services for files relying on the STM32 Cryptographic library. </p>
<p >The crypto service stores encrypted data and the corresponding encryption parameters in its own format due to the lack of stable and popular standards. </p>

<p class="definition">Definition in file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>
</div><h2 class="groupheader">Macro Definition Documentation</h2>
<a id="a010eb3b112e01e79f7c23a2c63ca7237" name="a010eb3b112e01e79f7c23a2c63ca7237"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a010eb3b112e01e79f7c23a2c63ca7237">&#9670;&nbsp;</a></span>EXEH_CURRENT_MODULE_ID</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define EXEH_CURRENT_MODULE_ID&#160;&#160;&#160;eEXEHModuleID_CRYPTO</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Module ID used for this file to report error events in EXEH. </p>

<p class="definition">Definition at line <a class="el" href="crypto_8c_source.html#l00042">42</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>

</div>
</div>
<a id="a14d36260412b53d3e4e3b1f434cde57a" name="a14d36260412b53d3e4e3b1f434cde57a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a14d36260412b53d3e4e3b1f434cde57a">&#9670;&nbsp;</a></span>UNBLOCK_CRYPTO_TASK</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define UNBLOCK_CRYPTO_TASK&#160;&#160;&#160;(0x10)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Flag value used with osThreadFlagsWait() to unblock main task in case a processing event. </p>

<p class="definition">Definition at line <a class="el" href="crypto_8c_source.html#l00045">45</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>

</div>
</div>
<a id="ae288ddbc3e28317cad52569beb5e8de6" name="ae288ddbc3e28317cad52569beb5e8de6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae288ddbc3e28317cad52569beb5e8de6">&#9670;&nbsp;</a></span>ENTROPY_SIZE_BYTES</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define ENTROPY_SIZE_BYTES&#160;&#160;&#160;(32U)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Number of bytes reserved for the RNG entropy seed. </p>

<p class="definition">Definition at line <a class="el" href="crypto_8c_source.html#l00048">48</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>

</div>
</div>
<a id="ad0678d7598078704533305ff431020be" name="ad0678d7598078704533305ff431020be"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad0678d7598078704533305ff431020be">&#9670;&nbsp;</a></span>NONCE_SIZE_BYTES</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define NONCE_SIZE_BYTES&#160;&#160;&#160;(16U)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Number of bytes to use for the nonce value generated initially for seeding DRBG library. </p>

<p class="definition">Definition at line <a class="el" href="crypto_8c_source.html#l00051">51</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>

</div>
</div>
<a id="a85fa5270b24b1f60562799e440e5a5bb" name="a85fa5270b24b1f60562799e440e5a5bb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a85fa5270b24b1f60562799e440e5a5bb">&#9670;&nbsp;</a></span>CIPHER_ALGO_NAME</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CIPHER_ALGO_NAME&#160;&#160;&#160;&quot;AES_256_GCM&quot;</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Name of the cipher algo used by this crypto service which will be provided as part of the <a class="el" href="structencrypted__data__hdr__t.html" title="EnduroSat encrypted data header format.">encrypted_data_hdr_t</a> block in the encrypted file. </p>

<p class="definition">Definition at line <a class="el" href="crypto_8c_source.html#l00054">54</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>

</div>
</div>
<a id="a0fda8a9df281605610a8be897d5c2e0c" name="a0fda8a9df281605610a8be897d5c2e0c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0fda8a9df281605610a8be897d5c2e0c">&#9670;&nbsp;</a></span>DATA_HDR_MAJOR</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define DATA_HDR_MAJOR&#160;&#160;&#160;(0U)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Major version of the <a class="el" href="structencrypted__data__hdr__t.html" title="EnduroSat encrypted data header format.">encrypted_data_hdr_t</a> block (increment when you make breaking changes to the header block) </p>

<p class="definition">Definition at line <a class="el" href="crypto_8c_source.html#l00057">57</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>

</div>
</div>
<a id="a62bcf47e4afad565136c344d668a9021" name="a62bcf47e4afad565136c344d668a9021"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a62bcf47e4afad565136c344d668a9021">&#9670;&nbsp;</a></span>DATA_HDR_MINOR</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define DATA_HDR_MINOR&#160;&#160;&#160;(1U)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Minor version of the <a class="el" href="structencrypted__data__hdr__t.html" title="EnduroSat encrypted data header format.">encrypted_data_hdr_t</a> block (increment when you make non-breaking changes to the header block) </p>

<p class="definition">Definition at line <a class="el" href="crypto_8c_source.html#l00060">60</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>

</div>
</div>
<h2 class="groupheader">Typedef Documentation</h2>
<a id="a168c9d83a8101193a548b4b514987c7c" name="a168c9d83a8101193a548b4b514987c7c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a168c9d83a8101193a548b4b514987c7c">&#9670;&nbsp;</a></span>p_stream_stage_pipeline_t</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef <a class="el" href="crypto_8h.html#ac2373ddb406a15dd452fcf61ab8ada10">crypto_api_res_t</a>(* p_stream_stage_pipeline_t) (<a class="el" href="structcrypto__stream__hnd__t.html">crypto_stream_hnd_t</a> *const p_stream_hnd, uint8_t *p_read_buf, uint8_t *const p_output_buf, const uint32_t bytes_to_read, uint32_t *const p_bytes_read)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>A function pointer to a stream pipeline handler. </p>
<p >This is a generic interface which provides a specific handling at each stage of the stream operations pipeline.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">p_stream_hnd</td><td>stream handler context structure (keeps the state of the stream) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">p_read_buf</td><td>a temporary read buffer provided for intermediate data storage (not all handlers will use that and it is a responsibility of the general handler to ensure the size of this buffer can accommodate bytes_to_read bytes </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">p_output_buf</td><td>this is the buffer where processed data shall be copied </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">bytes_to_read</td><td>number of bytes to read when the stage is executed </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">p_bytes_read</td><td>the buffer receives the actual number of bytes processed by the function and returned in p_output_buf</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>stream status after the stage completes </dd></dl>

<p class="definition">Definition at line <a class="el" href="crypto_8c_source.html#l00090">90</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="ac3bf2ce3168e1c3d238b103cac3bb639" name="ac3bf2ce3168e1c3d238b103cac3bb639"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac3bf2ce3168e1c3d238b103cac3bb639">&#9670;&nbsp;</a></span>is_key_valid()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">STATIC bool is_key_valid </td>
          <td>(</td>
          <td class="paramtype">const uint8_t *const&#160;</td>
          <td class="paramname"><em>p_key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t&#160;</td>
          <td class="paramname"><em>key_size</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Checks if the provided key is valid (i.e. being non-zero) </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">p_key</td><td>a pointer to the encryption key bytes </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">key_size</td><td>size of the key in bytes</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>true: the key has at least one non-zero byte; false: the key is all zeroes </dd></dl>

<p class="definition">Definition at line <a class="el" href="crypto_8c_source.html#l00556">556</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>

</div>
</div>
<a id="a2794b2ff999e33a6ace61e18999a70fc" name="a2794b2ff999e33a6ace61e18999a70fc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2794b2ff999e33a6ace61e18999a70fc">&#9670;&nbsp;</a></span>crypto_task()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">STATIC void crypto_task </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>p_task_arg</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Main Crypto service OS task function. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">p_task_arg</td><td>specific task parameters (unused) </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="crypto_8c_source.html#l00669">669</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>

</div>
</div>
<a id="a6236428545780735c02e4b04136ee1cd" name="a6236428545780735c02e4b04136ee1cd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6236428545780735c02e4b04136ee1cd">&#9670;&nbsp;</a></span>safe_copy_str()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">STATIC void safe_copy_str </td>
          <td>(</td>
          <td class="paramtype">char *const&#160;</td>
          <td class="paramname"><em>p_dst_str</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *const&#160;</td>
          <td class="paramname"><em>p_src_str</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const size_t&#160;</td>
          <td class="paramname"><em>dst_size</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>The function makes a copy of a null-terminated string to a buffer ensuring the buffer is null terminated even if the copy was partial. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">p_dst_str</td><td>a pointer to the beginning of the buffer to copy p_str_str to </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">p_src_str</td><td>a pointer to a null-terminated string to copy </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">dst_size</td><td>size of the buffer pointed to by p_dst_str </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="crypto_8c_source.html#l00583">583</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>

</div>
</div>
<a id="a84d06036031a531e7cecc323d05b2164" name="a84d06036031a531e7cecc323d05b2164"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a84d06036031a531e7cecc323d05b2164">&#9670;&nbsp;</a></span>queue_cipher_op()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">STATIC <a class="el" href="crypto_8h.html#a3857531fa232576dce194dd28b8ceba1">crypto_req_status_t</a> queue_cipher_op </td>
          <td>(</td>
          <td class="paramtype">const char *const&#160;</td>
          <td class="paramname"><em>p_src_file_name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *const&#160;</td>
          <td class="paramname"><em>p_target_file_name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="crypto_8h.html#a629f8bc4af94faad8768be934305d919">p_crypto_notif</a>&#160;</td>
          <td class="paramname"><em>p_user_cbk</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="crypto_8h.html#a43bf1ce3753a89393539d1c76255d47a">cipher_alg_type_t</a>&#160;</td>
          <td class="paramname"><em>alg_type</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Queues a cipher operation on a file for execution. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">p_src_file_name</td><td>name of the file to encrypt </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">p_target_file_name</td><td>name of the encrypted file to create on the SD card </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">p_user_cbk</td><td>a pointer to a user callback to be invoked when the encryption is finished</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>queue operation status </dd></dl>

<p class="definition">Definition at line <a class="el" href="crypto_8c_source.html#l00603">603</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>

</div>
</div>
<a id="ae36476fd4ae5980ac67aa8acc1443f84" name="ae36476fd4ae5980ac67aa8acc1443f84"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae36476fd4ae5980ac67aa8acc1443f84">&#9670;&nbsp;</a></span>csq_get_slot_data()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">STATIC void csq_get_slot_data </td>
          <td>(</td>
          <td class="paramtype">const uint32_t&#160;</td>
          <td class="paramname"><em>slot_idx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *const&#160;</td>
          <td class="paramname"><em>p_data_buf</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>User set function for CSQ_ALGO library. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">slot_idx</td><td>queue index to retrieve data from </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">p_data_buf</td><td>a buffer to receive a copy of the data at the given slot index</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>pointer to the data at the specified index </dd></dl>

<p class="definition">Definition at line <a class="el" href="crypto_8c_source.html#l00748">748</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>

</div>
</div>
<a id="a7a76ae397ee8436ab83da23730a31692" name="a7a76ae397ee8436ab83da23730a31692"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7a76ae397ee8436ab83da23730a31692">&#9670;&nbsp;</a></span>crypt_decrypt_file()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">STATIC <a class="el" href="crypto_8h.html#ac2373ddb406a15dd452fcf61ab8ada10">crypto_api_res_t</a> crypt_decrypt_file </td>
          <td>(</td>
          <td class="paramtype">const char *const&#160;</td>
          <td class="paramname"><em>p_src_file_name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *const&#160;</td>
          <td class="paramname"><em>p_target_file_name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="crypto_8h.html#a43bf1ce3753a89393539d1c76255d47a">cipher_alg_type_t</a>&#160;</td>
          <td class="paramname"><em>impl_type</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Performs a specified cipher algorithm on a file producing a new file with a given name. </p>
<dl class="section note"><dt>Note</dt><dd>The function does not modify the original file.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">p_src_file_name</td><td>original file name </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">p_target_file_name</td><td>processed file name </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">impl_type</td><td>specifies the type of algorithm to perform on the input file </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>see crypto_op_status_t values for details </dd></dl>

<p class="definition">Definition at line <a class="el" href="crypto_8c_source.html#l00799">799</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>

</div>
</div>
<a id="a878b66d27359fac280d277f220b6444f" name="a878b66d27359fac280d277f220b6444f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a878b66d27359fac280d277f220b6444f">&#9670;&nbsp;</a></span>generate_iv()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">STATIC void generate_iv </td>
          <td>(</td>
          <td class="paramtype">uint8_t *const&#160;</td>
          <td class="paramname"><em>p_iv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint32_t&#160;</td>
          <td class="paramname"><em>iv_size</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Performs a one-time generation of a random init vector for encryption. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">p_iv</td><td>a pointer to the buffer for the IV </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">iv_size</td><td>size of the IV buffer</td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>If the DRBG algo fails, then a hard-coded IV is used. </dd></dl>

<p class="definition">Definition at line <a class="el" href="crypto_8c_source.html#l00760">760</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>

</div>
</div>
<a id="a59def54a84b12a39a8be117bf6f2634a" name="a59def54a84b12a39a8be117bf6f2634a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a59def54a84b12a39a8be117bf6f2634a">&#9670;&nbsp;</a></span>prep_file_for_stream_encr()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">STATIC <a class="el" href="crypto_8h.html#ac2373ddb406a15dd452fcf61ab8ada10">crypto_api_res_t</a> prep_file_for_stream_encr </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structcrypto__stream__hnd__t.html">crypto_stream_hnd_t</a> *const&#160;</td>
          <td class="paramname"><em>p_stream_hnd</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Refer to <a class="el" href="crypto_8c.html#a168c9d83a8101193a548b4b514987c7c">p_stream_stage_pipeline_t</a> function pointer type for a description of all parameters here. </p>

<p class="definition">Definition at line <a class="el" href="crypto_8c_source.html#l00871">871</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>

</div>
</div>
<a id="aae1229e72ffe3c4866bf84fe60f5f0fd" name="aae1229e72ffe3c4866bf84fe60f5f0fd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aae1229e72ffe3c4866bf84fe60f5f0fd">&#9670;&nbsp;</a></span>prep_file_for_stream_decr()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">STATIC <a class="el" href="crypto_8h.html#ac2373ddb406a15dd452fcf61ab8ada10">crypto_api_res_t</a> prep_file_for_stream_decr </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structcrypto__stream__hnd__t.html">crypto_stream_hnd_t</a> *const&#160;</td>
          <td class="paramname"><em>p_stream_hnd</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Refer to <a class="el" href="crypto_8c.html#a168c9d83a8101193a548b4b514987c7c">p_stream_stage_pipeline_t</a> function pointer type for a description of all parameters here. </p>

<p class="definition">Definition at line <a class="el" href="crypto_8c_source.html#l00911">911</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>

</div>
</div>
<a id="a36802e5d89a9c008cbd8edf3f3c26dc7" name="a36802e5d89a9c008cbd8edf3f3c26dc7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a36802e5d89a9c008cbd8edf3f3c26dc7">&#9670;&nbsp;</a></span>read_from_buf()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">STATIC <a class="el" href="crypto_8h.html#ac2373ddb406a15dd452fcf61ab8ada10">crypto_api_res_t</a> read_from_buf </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structcrypto__stream__hnd__t.html">crypto_stream_hnd_t</a> *const&#160;</td>
          <td class="paramname"><em>p_stream_hnd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *const&#160;</td>
          <td class="paramname"><em>p_buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint32_t&#160;</td>
          <td class="paramname"><em>buf_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>p_read_buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *const&#160;</td>
          <td class="paramname"><em>p_output_buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint32_t&#160;</td>
          <td class="paramname"><em>bytes_to_read</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t *const&#160;</td>
          <td class="paramname"><em>p_bytes_read</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>A helper function to read a data in a streaming manner from a given buffer in RAM. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">p_stream_hnd</td><td>stream handler context structure (keeps the state of the stream) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">p_buf</td><td>a pointer to the data in RAM to be read as a stream </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">buf_size</td><td>size of the p_struct-pointed data in bytes </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">p_read_buf</td><td>a temporary read buffer provided for intermediate data storage (not all handlers will use that and it is a responsibility of the general handler to ensure the size of this buffer can accommodate bytes_to_read bytes </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">p_output_buf</td><td>this is the buffer where processed data shall be copied </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">bytes_to_read</td><td>number of bytes to read when the stage is executed </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">p_bytes_read</td><td>the buffer receives the actual number of bytes processed by the function and returned in p_output_buf</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>stream status after reading </dd></dl>

<p class="definition">Definition at line <a class="el" href="crypto_8c_source.html#l00969">969</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>

</div>
</div>
<a id="a6945a6149e9d71456052c190c617599d" name="a6945a6149e9d71456052c190c617599d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6945a6149e9d71456052c190c617599d">&#9670;&nbsp;</a></span>read_from_header()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">STATIC <a class="el" href="crypto_8h.html#ac2373ddb406a15dd452fcf61ab8ada10">crypto_api_res_t</a> read_from_header </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structcrypto__stream__hnd__t.html">crypto_stream_hnd_t</a> *const&#160;</td>
          <td class="paramname"><em>p_stream_hnd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>p_read_buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *const&#160;</td>
          <td class="paramname"><em>p_output_buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint32_t&#160;</td>
          <td class="paramname"><em>bytes_to_read</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t *const&#160;</td>
          <td class="paramname"><em>p_bytes_read</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Refer to <a class="el" href="crypto_8c.html#a168c9d83a8101193a548b4b514987c7c">p_stream_stage_pipeline_t</a> function pointer type for a description of all parameters here. </p>

<p class="definition">Definition at line <a class="el" href="crypto_8c_source.html#l01003">1003</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>

</div>
</div>
<a id="a1763f5163b0a7cec714226b4f418fbab" name="a1763f5163b0a7cec714226b4f418fbab"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1763f5163b0a7cec714226b4f418fbab">&#9670;&nbsp;</a></span>read_from_temp_buf()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">STATIC <a class="el" href="crypto_8h.html#ac2373ddb406a15dd452fcf61ab8ada10">crypto_api_res_t</a> read_from_temp_buf </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structcrypto__stream__hnd__t.html">crypto_stream_hnd_t</a> *const&#160;</td>
          <td class="paramname"><em>p_stream_hnd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>p_read_buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *const&#160;</td>
          <td class="paramname"><em>p_output_buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint32_t&#160;</td>
          <td class="paramname"><em>bytes_to_read</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t *const&#160;</td>
          <td class="paramname"><em>p_bytes_read</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="crypto_8c_source.html#l01293">1293</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>

</div>
</div>
<a id="afc4f807d6701c6b7a2fe29685614be59" name="afc4f807d6701c6b7a2fe29685614be59"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afc4f807d6701c6b7a2fe29685614be59">&#9670;&nbsp;</a></span>read_from_footer()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">STATIC <a class="el" href="crypto_8h.html#ac2373ddb406a15dd452fcf61ab8ada10">crypto_api_res_t</a> read_from_footer </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structcrypto__stream__hnd__t.html">crypto_stream_hnd_t</a> *const&#160;</td>
          <td class="paramname"><em>p_stream_hnd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>p_read_buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *const&#160;</td>
          <td class="paramname"><em>p_output_buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint32_t&#160;</td>
          <td class="paramname"><em>bytes_to_read</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t *const&#160;</td>
          <td class="paramname"><em>p_bytes_read</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Refer to <a class="el" href="crypto_8c.html#a168c9d83a8101193a548b4b514987c7c">p_stream_stage_pipeline_t</a> function pointer type for a description of all parameters here. </p>

<p class="definition">Definition at line <a class="el" href="crypto_8c_source.html#l01016">1016</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>

</div>
</div>
<a id="a0d805a0841a200cc48d42efab899e172" name="a0d805a0841a200cc48d42efab899e172"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0d805a0841a200cc48d42efab899e172">&#9670;&nbsp;</a></span>prepare_footer()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">STATIC <a class="el" href="crypto_8h.html#ac2373ddb406a15dd452fcf61ab8ada10">crypto_api_res_t</a> prepare_footer </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structcrypto__stream__hnd__t.html">crypto_stream_hnd_t</a> *const&#160;</td>
          <td class="paramname"><em>p_stream_hnd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>p_read_buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *const&#160;</td>
          <td class="paramname"><em>p_output_buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint32_t&#160;</td>
          <td class="paramname"><em>bytes_to_read</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t *const&#160;</td>
          <td class="paramname"><em>p_bytes_read</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Refer to <a class="el" href="crypto_8c.html#a168c9d83a8101193a548b4b514987c7c">p_stream_stage_pipeline_t</a> function pointer type for a description of all parameters here. </p>

<p class="definition">Definition at line <a class="el" href="crypto_8c_source.html#l01181">1181</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>

</div>
</div>
<a id="ada9232ae8800c2c5351e062f76d63afd" name="ada9232ae8800c2c5351e062f76d63afd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ada9232ae8800c2c5351e062f76d63afd">&#9670;&nbsp;</a></span>verify_footer()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">STATIC <a class="el" href="crypto_8h.html#ac2373ddb406a15dd452fcf61ab8ada10">crypto_api_res_t</a> verify_footer </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structcrypto__stream__hnd__t.html">crypto_stream_hnd_t</a> *const&#160;</td>
          <td class="paramname"><em>p_stream_hnd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>p_read_buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *const&#160;</td>
          <td class="paramname"><em>p_output_buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint32_t&#160;</td>
          <td class="paramname"><em>bytes_to_read</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t *const&#160;</td>
          <td class="paramname"><em>p_bytes_read</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Refer to <a class="el" href="crypto_8c.html#a168c9d83a8101193a548b4b514987c7c">p_stream_stage_pipeline_t</a> function pointer type for a description of all parameters here. </p>

<p class="definition">Definition at line <a class="el" href="crypto_8c_source.html#l01220">1220</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>

</div>
</div>
<a id="aca2df3e1b39c604531737ba11b3d892f" name="aca2df3e1b39c604531737ba11b3d892f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aca2df3e1b39c604531737ba11b3d892f">&#9670;&nbsp;</a></span>read_chunk_and_process()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">STATIC <a class="el" href="crypto_8h.html#ac2373ddb406a15dd452fcf61ab8ada10">crypto_api_res_t</a> read_chunk_and_process </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structcrypto__stream__hnd__t.html">crypto_stream_hnd_t</a> *const&#160;</td>
          <td class="paramname"><em>p_stream_hnd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>p_read_buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *const&#160;</td>
          <td class="paramname"><em>p_output_buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint32_t&#160;</td>
          <td class="paramname"><em>bytes_to_read</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t *const&#160;</td>
          <td class="paramname"><em>p_bytes_read</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Refer to <a class="el" href="crypto_8c.html#a168c9d83a8101193a548b4b514987c7c">p_stream_stage_pipeline_t</a> function pointer type for a description of all parameters here. </p>

<p class="definition">Definition at line <a class="el" href="crypto_8c_source.html#l01090">1090</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>

</div>
</div>
<a id="ab34aa06d7449193e45b084cbc2ffb7c8" name="ab34aa06d7449193e45b084cbc2ffb7c8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab34aa06d7449193e45b084cbc2ffb7c8">&#9670;&nbsp;</a></span>prepare_temp_buf()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">STATIC <a class="el" href="crypto_8h.html#ac2373ddb406a15dd452fcf61ab8ada10">crypto_api_res_t</a> prepare_temp_buf </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structcrypto__stream__hnd__t.html">crypto_stream_hnd_t</a> *const&#160;</td>
          <td class="paramname"><em>p_stream_hnd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>p_read_buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *const&#160;</td>
          <td class="paramname"><em>p_output_buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint32_t&#160;</td>
          <td class="paramname"><em>bytes_to_read</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t *const&#160;</td>
          <td class="paramname"><em>p_bytes_read</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="crypto_8c_source.html#l01029">1029</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>

</div>
</div>
<a id="a85ea4ad34e77eb6e093b4c01656807df" name="a85ea4ad34e77eb6e093b4c01656807df"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a85ea4ad34e77eb6e093b4c01656807df">&#9670;&nbsp;</a></span>read_from_file()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">STATIC <a class="el" href="crypto_8h.html#ac2373ddb406a15dd452fcf61ab8ada10">crypto_api_res_t</a> read_from_file </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structcrypto__stream__hnd__t.html">crypto_stream_hnd_t</a> *const&#160;</td>
          <td class="paramname"><em>p_stream_hnd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>p_read_buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *const&#160;</td>
          <td class="paramname"><em>p_output_buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint32_t&#160;</td>
          <td class="paramname"><em>bytes_to_read</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t *const&#160;</td>
          <td class="paramname"><em>p_bytes_read</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="crypto_8c_source.html#l01308">1308</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>

</div>
</div>
<a id="a1b4d840d55407fad7c0b34d2cd1da6b9" name="a1b4d840d55407fad7c0b34d2cd1da6b9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1b4d840d55407fad7c0b34d2cd1da6b9">&#9670;&nbsp;</a></span>set_next_stage()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">STATIC void set_next_stage </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structcrypto__stream__hnd__t.html">crypto_stream_hnd_t</a> *const&#160;</td>
          <td class="paramname"><em>p_stream_hnd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="crypto_8c.html#a168c9d83a8101193a548b4b514987c7c">p_stream_stage_pipeline_t</a> const&#160;</td>
          <td class="paramname"><em>p_next_stage</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="crypto_8c_source.html#l01279">1279</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>

</div>
</div>
<a id="a2ca66594182ad6110b531bee690b1c56" name="a2ca66594182ad6110b531bee690b1c56"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2ca66594182ad6110b531bee690b1c56">&#9670;&nbsp;</a></span>crypto_init()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void crypto_init </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initialises the service memory and prepares it for operation. </p>
<p >&lt; OBC module version info used to seed DRBG library with additional data</p>

<p class="definition">Definition at line <a class="el" href="crypto_8c_source.html#l00179">179</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>

</div>
</div>
<a id="a77ae468abdc9ed68f924dcfbefe723f1" name="a77ae468abdc9ed68f924dcfbefe723f1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a77ae468abdc9ed68f924dcfbefe723f1">&#9670;&nbsp;</a></span>crypto_start()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void crypto_start </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Spawns the service OS-tasks and enables the service API. </p>

<p class="definition">Definition at line <a class="el" href="crypto_8c_source.html#l00231">231</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>

</div>
</div>
<a id="adce817ec6205757405b5777ebf952590" name="adce817ec6205757405b5777ebf952590"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adce817ec6205757405b5777ebf952590">&#9670;&nbsp;</a></span>crypto_std_encrypt_file()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="crypto_8h.html#a3857531fa232576dce194dd28b8ceba1">crypto_req_status_t</a> crypto_std_encrypt_file </td>
          <td>(</td>
          <td class="paramtype">const char *const&#160;</td>
          <td class="paramname"><em>p_src_file_name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *const&#160;</td>
          <td class="paramname"><em>p_target_file_name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="crypto_8h.html#a629f8bc4af94faad8768be934305d919">p_crypto_notif</a>&#160;</td>
          <td class="paramname"><em>p_user_cbk</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>The operation queues a user-specified file for encryption using the default (pre-configured) cipher algorithm. </p>
<p >As the operation may take longer depending on the size of the file, the Crypto service will notify the user if a user-callback is supplied as part of the p_file_req structure.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">p_src_file_name</td><td>name of the file to encrypt </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">p_target_file_name</td><td>name of the encrypted file to create on the SD card </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">p_user_cbk</td><td>a pointer to a user callback to be invoked when the encryption is finished</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>status of the requested operation </dd></dl>

<p class="definition">Definition at line <a class="el" href="crypto_8c_source.html#l00268">268</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>

</div>
</div>
<a id="a71ae81007dcc0de5af06a2d191e3f7b2" name="a71ae81007dcc0de5af06a2d191e3f7b2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a71ae81007dcc0de5af06a2d191e3f7b2">&#9670;&nbsp;</a></span>crypto_std_decrypt_file()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="crypto_8h.html#a3857531fa232576dce194dd28b8ceba1">crypto_req_status_t</a> crypto_std_decrypt_file </td>
          <td>(</td>
          <td class="paramtype">const char *const&#160;</td>
          <td class="paramname"><em>p_src_file_name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *const&#160;</td>
          <td class="paramname"><em>p_target_file_name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="crypto_8h.html#a629f8bc4af94faad8768be934305d919">p_crypto_notif</a>&#160;</td>
          <td class="paramname"><em>p_user_cbk</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>The operation queues a user-specified file for decryption using the default (pre-configured) cipher algorithm. </p>
<p >As the operation may take longer depending on the size of the file, the Crypto service will notify the user if a user-callback is supplied as part of the p_file_req structure.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">p_src_file_name</td><td>name of the file to decrypt </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">p_target_file_name</td><td>name of the decrypted file to create on the SD card </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">p_user_cbk</td><td>a pointer to a user callback to be invoked when the decryption is finished</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>status of the requested operation </dd></dl>

<p class="definition">Definition at line <a class="el" href="crypto_8c_source.html#l00273">273</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>

</div>
</div>
<a id="aca7afcf337d284c83847da9c8c3ed1fe" name="aca7afcf337d284c83847da9c8c3ed1fe"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aca7afcf337d284c83847da9c8c3ed1fe">&#9670;&nbsp;</a></span>crypto_update_key_store()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="crypto_8h.html#a8bf9a47ecfcca260eea93f9aa5de1fe7">crypto_key_upd_status_t</a> crypto_update_key_store </td>
          <td>(</td>
          <td class="paramtype">const uint8_t *const&#160;</td>
          <td class="paramname"><em>p_key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t&#160;</td>
          <td class="paramname"><em>key_size</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Updates the symmetric encryption key to the currently configured key store. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">p_key</td><td>a pointer to the key data </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">key_size</td><td>size of the key in bytes (for the current AES CGM encryption, a 32-byte key is expected)</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>see crypto_key_upd_status_t type values for details </dd></dl>

<p class="definition">Definition at line <a class="el" href="crypto_8c_source.html#l00278">278</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>

</div>
</div>
<a id="aee4c21424d6d701cf8dd4b33f35bad91" name="aee4c21424d6d701cf8dd4b33f35bad91"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aee4c21424d6d701cf8dd4b33f35bad91">&#9670;&nbsp;</a></span>crypto_abort()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void crypto_abort </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="crypto_8h.html#a1718915519b2668786d8cc0719d1f447">crypto_abort_op_t</a>&#160;</td>
          <td class="paramname"><em>op_type</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Aborts one or more cipher operations. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">op_type</td><td>type of abort operation to execute </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="crypto_8c_source.html#l00301">301</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>

</div>
</div>
<a id="ae0f55316df548f92944a39aeea11f21f" name="ae0f55316df548f92944a39aeea11f21f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae0f55316df548f92944a39aeea11f21f">&#9670;&nbsp;</a></span>crypto_stream_open_always()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="crypto_8h.html#ac2373ddb406a15dd452fcf61ab8ada10">crypto_api_res_t</a> crypto_stream_open_always </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structcrypto__stream__hnd__t.html">crypto_stream_hnd_t</a> *const&#160;</td>
          <td class="paramname"><em>p_stream_hnd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *const&#160;</td>
          <td class="paramname"><em>p_src_file_name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="crypto_8h.html#a43bf1ce3753a89393539d1c76255d47a">cipher_alg_type_t</a>&#160;</td>
          <td class="paramname"><em>impl_type</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Opens a crypto stream from a file. </p>
<p >The function performs streaming encryption/decryption only if a key is programmed in the device. Otherwise it will fail.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">p_stream_hnd</td><td>user stream context structure </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">p_src_file_name</td><td>name of the file to open for stream operation </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">impl_type</td><td>type of cipher algorithm to use for the stream read operations</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>stream status </dd></dl>

<p class="definition">Definition at line <a class="el" href="crypto_8c_source.html#l00314">314</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>

</div>
</div>
<a id="a2b879d39e255689c68c0c396b4e88a51" name="a2b879d39e255689c68c0c396b4e88a51"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2b879d39e255689c68c0c396b4e88a51">&#9670;&nbsp;</a></span>crypto_stream_open()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="crypto_8h.html#ac2373ddb406a15dd452fcf61ab8ada10">crypto_api_res_t</a> crypto_stream_open </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structcrypto__stream__hnd__t.html">crypto_stream_hnd_t</a> *const&#160;</td>
          <td class="paramname"><em>p_stream_hnd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *const&#160;</td>
          <td class="paramname"><em>p_src_file_name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="crypto_8h.html#a43bf1ce3753a89393539d1c76255d47a">cipher_alg_type_t</a>&#160;</td>
          <td class="paramname"><em>impl_type</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Opens a crypto stream from a file. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">p_stream_hnd</td><td>user stream context structure </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">p_src_file_name</td><td>name of the file to open for stream operation </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">impl_type</td><td>type of cipher algorithm to use for the stream read operations</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>stream status (the function will fail with CRYPTO_API_RES_NO_KEY is no key is programmed in the device) </dd></dl>

<p class="definition">Definition at line <a class="el" href="crypto_8c_source.html#l00358">358</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>

</div>
</div>
<a id="adb125e25edeaf7abe00dd06fe4732d68" name="adb125e25edeaf7abe00dd06fe4732d68"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adb125e25edeaf7abe00dd06fe4732d68">&#9670;&nbsp;</a></span>crypto_stream_read()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="crypto_8h.html#ac2373ddb406a15dd452fcf61ab8ada10">crypto_api_res_t</a> crypto_stream_read </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structcrypto__stream__hnd__t.html">crypto_stream_hnd_t</a> *const&#160;</td>
          <td class="paramname"><em>p_stream_hnd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *const&#160;</td>
          <td class="paramname"><em>p_output_buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint32_t&#160;</td>
          <td class="paramname"><em>output_buf_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t *const&#160;</td>
          <td class="paramname"><em>p_bytes_read</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Reads data from an opened stream using the associated cipher algorithm. </p>
<p >The function performs streaming encryption/decryption if a key is programmed in the device but if no key is available, it will just open the file as a plain stream and will read from it, i.e. it will not fail as @crypto_stream_open will do. The function is useful if you want to support cipher operations in your implementation but if the device is not provisioned, your code will still return data as a result of the stream read calls but that data will be in plain form.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">p_stream_hnd</td><td>user stream context structure </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">p_output_buf</td><td>output buffer where streamed data is written to </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">output_buf_size</td><td>size of the output buffer in bytes </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">p_bytes_read</td><td>number of actual bytes read from the stream on this call (should usually match the output_buf_size unless the stream ends before the output buffer is filled-in</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>stream status </dd></dl>

<p class="definition">Definition at line <a class="el" href="crypto_8c_source.html#l00464">464</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>

</div>
</div>
<a id="abbf4c36f9b9564fdc5538dfa9e0328c7" name="abbf4c36f9b9564fdc5538dfa9e0328c7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abbf4c36f9b9564fdc5538dfa9e0328c7">&#9670;&nbsp;</a></span>crypto_stream_get_size()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="crypto_8h.html#ac2373ddb406a15dd452fcf61ab8ada10">crypto_api_res_t</a> crypto_stream_get_size </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structcrypto__stream__hnd__t.html">crypto_stream_hnd_t</a> *const&#160;</td>
          <td class="paramname"><em>p_stream_hnd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t *const&#160;</td>
          <td class="paramname"><em>p_stream_size</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns the final size of the associated cipher stream in bytes. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">p_stream_hnd</td><td>user stream context structure </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">p_stream_size</td><td>buffer where to store the stream size</td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>The stream must have been opened before trying to get the associated size.</dd></dl>
<dl class="section return"><dt>Returns</dt><dd>stream status </dd></dl>

<p class="definition">Definition at line <a class="el" href="crypto_8c_source.html#l00518">518</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>

</div>
</div>
<a id="a666d95b9c795fdc51f1c25af61ae6e43" name="a666d95b9c795fdc51f1c25af61ae6e43"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a666d95b9c795fdc51f1c25af61ae6e43">&#9670;&nbsp;</a></span>crypto_stream_close()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void crypto_stream_close </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structcrypto__stream__hnd__t.html">crypto_stream_hnd_t</a> *const&#160;</td>
          <td class="paramname"><em>p_stream_hnd</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Closes an active stream and frees all resources. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">p_stream_hnd</td><td>user stream context structure </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="crypto_8c_source.html#l00537">537</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="a489754f4b059d9f404f6bfe72f4a1e30" name="a489754f4b059d9f404f6bfe72f4a1e30"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a489754f4b059d9f404f6bfe72f4a1e30">&#9670;&nbsp;</a></span>cipher_alg_map</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="structcipher__entry__t.html">cipher_entry_t</a> cipher_alg_map[OP_CMOX_MAX]</td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">=</div>
<div class="line">{</div>
<div class="line">    { OP_CMOX_AES_GCM_ENC, &amp;CMOX_AES_GCM_ENC },</div>
<div class="line">    { OP_CMOX_AES_GCM_DEC, &amp;CMOX_AES_GCM_DEC },</div>
<div class="line">}</div>
</div><!-- fragment -->
<p>Cipher algo map. </p>

<p class="definition">Definition at line <a class="el" href="crypto_8c_source.html#l00153">153</a> of file <a class="el" href="crypto_8c_source.html">crypto.c</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.9.5-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_e2c83a6801e015e427e1c55223a130e1.html">espf</a></li><li class="navelem"><a class="el" href="dir_99f3dafb56e7a0be84da390df3a0ec4d.html">core</a></li><li class="navelem"><a class="el" href="dir_5013bdea625176bf2964ef0fdf345617.html">services</a></li><li class="navelem"><a class="el" href="dir_60ac0eabb108ba5e074eca014d314490.html">crypto</a></li><li class="navelem"><a class="el" href="dir_bc4c38b6503376c986574c283d4f9718.html">src</a></li><li class="navelem"><a class="el" href="crypto_8c.html">crypto.c</a></li>
    <li class="footer">Generated by Doxygen 1.9.4 </li>
  </ul>
</div>
</body>
</html>
