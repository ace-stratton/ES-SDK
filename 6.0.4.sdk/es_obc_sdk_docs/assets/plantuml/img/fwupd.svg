<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="740px" preserveAspectRatio="none" style="width:2045px;height:740px;background:#FFFFFF;" version="1.1" viewBox="0 0 2045 740" width="2045px" zoomAndPan="magnify"><defs/><g><rect fill="#FFFFFF" height="93.3984" style="stroke:#181818;stroke-width:1.0;" width="10" x="551" y="161.8281"/><rect fill="#FFFFFF" height="29.1328" style="stroke:#181818;stroke-width:1.0;" width="10" x="1023" y="226.0938"/><rect fill="#FFFFFF" height="327.1797" style="stroke:#181818;stroke-width:1.0;" width="10" x="1577.5" y="361.2813"/><rect fill="#FFFFFF" height="298.0469" style="stroke:#181818;stroke-width:1.0;" width="10" x="1804.5" y="390.4141"/><rect fill="none" height="600.0313" style="stroke:#000000;stroke-width:1.5;" width="1898.5" x="130" y="88.4297"/><rect fill="none" height="198.7813" style="stroke:#000000;stroke-width:1.5;" width="788.5" x="1230" y="482.6797"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="68" x2="68" y1="36.2969" y2="705.4609"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="211" x2="211" y1="36.2969" y2="705.4609"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="556" x2="556" y1="36.2969" y2="705.4609"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1027.5" x2="1027.5" y1="36.2969" y2="705.4609"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1298" x2="1298" y1="36.2969" y2="705.4609"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1397" x2="1397" y1="36.2969" y2="705.4609"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1464" x2="1464" y1="36.2969" y2="705.4609"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1582" x2="1582" y1="36.2969" y2="705.4609"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1809" x2="1809" y1="36.2969" y2="705.4609"/><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="123" x="7" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="109" x="14" y="24.9951">Ground Station</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="123" x="7" y="704.4609"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="109" x="14" y="724.4561">Ground Station</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="142" x="140" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="128" x="147" y="24.9951">OBC::ESPS I stack</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="142" x="140" y="704.4609"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="128" x="147" y="724.4561">OBC::ESPS I stack</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="172" x="470" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="158" x="477" y="24.9951">FWUPD_Handler_Cfg.c</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="172" x="470" y="704.4609"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="158" x="477" y="724.4561">FWUPD_Handler_Cfg.c</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="131" x="962.5" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="117" x="969.5" y="24.9951">CommandsApi.c</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="131" x="962.5" y="704.4609"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="117" x="969.5" y="724.4561">CommandsApi.c</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="116" x="1240" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="102" x="1247" y="24.9951">TaskMonitor.c</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="116" x="1240" y="704.4609"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="102" x="1247" y="724.4561">TaskMonitor.c</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="62" x="1366" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="48" x="1373" y="24.9951">main.c</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="62" x="1366" y="704.4609"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="48" x="1373" y="724.4561">main.c</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="53" x="1438" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="39" x="1445" y="24.9951">RTOS</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="53" x="1438" y="704.4609"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="39" x="1445" y="724.4561">RTOS</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="93" x="1536" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="79" x="1543" y="24.9951">DefTasks.c</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="93" x="1536" y="704.4609"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="79" x="1543" y="724.4561">DefTasks.c</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="85" x="1767" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="71" x="1774" y="24.9951">BootLdr.c</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="85" x="1767" y="704.4609"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="71" x="1774" y="724.4561">BootLdr.c</text><rect fill="#FFFFFF" height="93.3984" style="stroke:#181818;stroke-width:1.0;" width="10" x="551" y="161.8281"/><rect fill="#FFFFFF" height="29.1328" style="stroke:#181818;stroke-width:1.0;" width="10" x="1023" y="226.0938"/><rect fill="#FFFFFF" height="327.1797" style="stroke:#181818;stroke-width:1.0;" width="10" x="1577.5" y="361.2813"/><rect fill="#FFFFFF" height="298.0469" style="stroke:#181818;stroke-width:1.0;" width="10" x="1804.5" y="390.4141"/><path d="M5,51.2969 L5,76.2969 L275,76.2969 L275,61.2969 L265,51.2969 L5,51.2969 " fill="#FFA500" style="stroke:#181818;stroke-width:0.5;"/><path d="M265,51.2969 L265,61.2969 L275,61.2969 L265,51.2969 " fill="#FFA500" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="203" x="34" y="68.3638">File transfer session in progress</text><path d="M130,88.4297 L202,88.4297 L202,95.5625 L192,105.5625 L130,105.5625 L130,88.4297 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="600.0313" style="stroke:#000000;stroke-width:1.5;" width="1898.5" x="130" y="88.4297"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="27" x="145" y="101.4966">opt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="291" x="217" y="100.6401">[File transfer session finished successfully]</text><path d="M146,110.5625 L146,135.5625 L551,135.5625 L551,120.5625 L541,110.5625 L146,110.5625 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M541,110.5625 L541,120.5625 L551,120.5625 L541,110.5625 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="384" x="152" y="127.6294">this is a notification for a complete update package transfer</text><polygon fill="#181818" points="539,157.8281,549,161.8281,539,165.8281,543,161.8281" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="211" x2="545" y1="161.8281" y2="161.8281"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="321" x="218" y="156.7622">FWUPD_Handler_Cfg_HandleTransferComplete(...)</text><path d="M530,174.8281 L530,199.8281 L1023,199.8281 L1023,184.8281 L1013,174.8281 L530,174.8281 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1013,174.8281 L1013,184.8281 L1023,184.8281 L1013,174.8281 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="472" x="536" y="191.895">reconfigure boot flags and trigger a subsequent reset in Bootloader mode</text><polygon fill="#181818" points="1011,222.0938,1021,226.0938,1011,230.0938,1015,226.0938" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="561" x2="1017" y1="226.0938" y2="226.0938"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="443" x="568" y="221.0278">WriteHandler_ResetInBootOrAppMode(APPMODE_AUTO_FW_UPDATE)</text><polygon fill="#181818" points="1286,251.2266,1296,255.2266,1286,259.2266,1290,255.2266" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1028" x2="1292" y1="255.2266" y2="255.2266"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="241" x="1035" y="250.1606">TaskMonitor_TriggerDelayedReset(...)</text><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1.0;" width="2038.5" x="0" y="286.1211"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="2038.5" y1="286.1211" y2="286.1211"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="2038.5" y1="289.1211" y2="289.1211"/><rect fill="#EEEEEE" height="27.7891" style="stroke:#000000;stroke-width:2.0;" width="339" x="849.75" y="273.2266"/><text fill="#000000" font-family="sans-serif" font-size="17" font-weight="bold" lengthAdjust="spacing" textLength="325" x="855.75" y="293.0063">OBC starts in Bootloader mode =</text><polygon fill="#181818" points="1797.5,328.1484,1807.5,332.1484,1797.5,336.1484,1801.5,332.1484" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1397" x2="1803.5" y1="332.1484" y2="332.1484"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="164" x="1404" y="327.0825">BootLdr_BootingProcess()</text><polygon fill="#181818" points="1565.5,357.2813,1575.5,361.2813,1565.5,365.2813,1569.5,361.2813" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1464.5" x2="1571.5" y1="361.2813" y2="361.2813"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="94" x="1471.5" y="356.2153">ServicesTask()</text><polygon fill="#181818" points="1792.5,386.4141,1802.5,390.4141,1792.5,394.4141,1796.5,390.4141" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1587.5" x2="1798.5" y1="390.4141" y2="390.4141"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="198" x="1594.5" y="385.3481">BootLdr_CheckAutoFlashCmd()</text><line style="stroke:#181818;stroke-width:1.0;" x1="1814.5" x2="1856.5" y1="419.5469" y2="419.5469"/><line style="stroke:#181818;stroke-width:1.0;" x1="1856.5" x2="1856.5" y1="419.5469" y2="432.5469"/><line style="stroke:#181818;stroke-width:1.0;" x1="1815.5" x2="1856.5" y1="432.5469" y2="432.5469"/><polygon fill="#181818" points="1825.5,428.5469,1815.5,432.5469,1825.5,436.5469,1821.5,432.5469" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="181" x="1821.5" y="414.481">BootLdr_AutoFlashFromBin()</text><path d="M1607,445.5469 L1607,470.5469 L2011,470.5469 L2011,455.5469 L2001,445.5469 L1607,445.5469 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M2001,445.5469 L2001,455.5469 L2011,455.5469 L2001,445.5469 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="383" x="1613" y="462.6138">perform FLASH erase and flashing of new application blocks</text><path d="M1230,482.6797 L1302,482.6797 L1302,489.8125 L1292,499.8125 L1230,499.8125 L1230,482.6797 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="198.7813" style="stroke:#000000;stroke-width:1.5;" width="788.5" x="1230" y="482.6797"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="27" x="1245" y="495.7466">opt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="294" x="1317" y="494.8901">[file CRC matches CRC of flashed database]</text><line style="stroke:#181818;stroke-width:1.0;" x1="1814.5" x2="1856.5" y1="520.9453" y2="520.9453"/><line style="stroke:#181818;stroke-width:1.0;" x1="1856.5" x2="1856.5" y1="520.9453" y2="533.9453"/><line style="stroke:#181818;stroke-width:1.0;" x1="1815.5" x2="1856.5" y1="533.9453" y2="533.9453"/><polygon fill="#181818" points="1825.5,529.9453,1815.5,533.9453,1825.5,537.9453,1821.5,533.9453" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="185" x="1821.5" y="515.8794">BootLdr_ImmediatAppJump()</text><polygon fill="#181818" points="1309,559.0781,1299,563.0781,1309,567.0781,1305,563.0781" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1303" x2="1803.5" y1="563.0781" y2="563.0781"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="367" x="1315" y="558.0122">TaskMonitor_ImmediatReset(TASK_MONITOR_SW_RESET)</text><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1.0;" width="2038.5" x="0" y="593.9727"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="2038.5" y1="593.9727" y2="593.9727"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="2038.5" y1="596.9727" y2="596.9727"/><rect fill="#EEEEEE" height="27.7891" style="stroke:#000000;stroke-width:2.0;" width="337" x="850.75" y="581.0781"/><text fill="#000000" font-family="sans-serif" font-size="17" font-weight="bold" lengthAdjust="spacing" textLength="323" x="856.75" y="600.8579">OBC boots the new Application =</text><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1230" x2="2018.5" y1="619.8672" y2="619.8672"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="166" x="1235" y="630.0776">[flashing error occurred]</text><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1.0;" width="2038.5" x="0" y="656.5664"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="2038.5" y1="656.5664" y2="656.5664"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="2038.5" y1="659.5664" y2="659.5664"/><rect fill="#EEEEEE" height="27.7891" style="stroke:#000000;stroke-width:2.0;" width="355" x="841.75" y="643.6719"/><text fill="#000000" font-family="sans-serif" font-size="17" font-weight="bold" lengthAdjust="spacing" textLength="341" x="847.75" y="663.4517">OBC remains in Bootloader mode =</text><!--MD5=[3b6cc854d8e8a6609781b74210b7a282]
@startuml
participant GS as "Ground Station"
participant espsi as "OBC::ESPS I stack"
participant FWUPDH as "FWUPD_Handler_Cfg.c"
participant CommApi as "CommandsApi.c"
participant TaskMon as "TaskMonitor.c"
participant OBCMain as "main.c"
participant RTOS
participant DefTasks as "DefTasks.c"
participant BootLdr as "BootLdr.c"

note over GS, espsi #orange: File transfer session in progress

opt File transfer session finished successfully
note left of FWUPDH: this is a notification for a complete update package transfer
espsi -> FWUPDH: FWUPD_Handler_Cfg_HandleTransferComplete(...)
activate FWUPDH
note left of CommApi: reconfigure boot flags and trigger a subsequent reset in Bootloader mode
FWUPDH -> CommApi: WriteHandler_ResetInBootOrAppMode(APPMODE_AUTO_FW_UPDATE)
activate CommApi
CommApi -> TaskMon: TaskMonitor_TriggerDelayedReset(...)

deactivate FWUPDH
deactivate CommApi

=== OBC starts in Bootloader mode ===
OBCMain -> BootLdr: BootLdr_BootingProcess()
RTOS -> DefTasks: ServicesTask()
activate DefTasks
DefTasks -> BootLdr: BootLdr_CheckAutoFlashCmd()
activate BootLdr
BootLdr -> BootLdr: BootLdr_AutoFlashFromBin()
note over BootLdr: perform FLASH erase and flashing of new application blocks
opt file CRC matches CRC of flashed database
BootLdr -> BootLdr: BootLdr_ImmediatAppJump()
BootLdr -> TaskMon: TaskMonitor_ImmediatReset(TASK_MONITOR_SW_RESET)
=== OBC boots the new Application ===
else flashing error occurred
=== OBC remains in Bootloader mode ===
end opt
deactivate BootLdr
deactivate DefTasks

end opt
@enduml

PlantUML version 1.2022.13beta8(Unknown compile time)
(GPL source distribution)
Java Runtime: Java(TM) SE Runtime Environment
JVM: Java HotSpot(TM) 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>