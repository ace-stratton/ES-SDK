
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://endurosat.com/devguide/devguide_fwupd.html">
      
      
        <link rel="prev" href="devguide_esps_cmd_extend.html">
      
      
        <link rel="next" href="devguide_debugtrace.html">
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.0, mkdocs-material-9.5.27">
    
    
      
        <title>Bootloader and firmware updates handling - EnduroSat On-Board Computer SDK Documentation</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.6543a935.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
        <script src="https://unpkg.com/iframe-worker/shim"></script>
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.7/katex.min.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
   <link href="../assets/stylesheets/glightbox.min.css" rel="stylesheet"/><style>
    html.glightbox-open { overflow: initial; height: 100%; }
    .gslide-title { margin-top: 0px; user-select: text; }
    .gslide-desc { color: #666; user-select: text; }
    .gslide-image img { background: white; }
    .gscrollbar-fixer { padding-right: 15px; }
    .gdesc-inner { font-size: 0.75rem; }
    body[data-md-color-scheme="slate"] .gdesc-inner { background: var(--md-default-bg-color);}
    body[data-md-color-scheme="slate"] .gslide-title { color: var(--md-default-fg-color);}
    body[data-md-color-scheme="slate"] .gslide-desc { color: var(--md-default-fg-color);}</style> <script src="../assets/javascripts/glightbox.min.js"></script></head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="black" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#bootloader" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../index.html" title="EnduroSat On-Board Computer SDK Documentation" class="md-header__button md-logo" aria-label="EnduroSat On-Board Computer SDK Documentation" data-md-component="logo">
      
  <img src="../EnduroSat_horLogo_symbol@2x-min.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            EnduroSat On-Board Computer SDK Documentation
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Bootloader and firmware updates handling
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
          <a href="javascript:void(0)" class="md-search__icon md-icon" title="Share" aria-label="Share" data-clipboard data-clipboard-text="" data-md-component="search-share" tabindex="-1">
            
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7 0-.24-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91 1.61 0 2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08Z"/></svg>
          </a>
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../index.html" class="md-tabs__link">
        
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../quickstart.html" class="md-tabs__link">
        
  
    
  
  Quick-start Guide

      </a>
    </li>
  

      
        
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="hldesign.html" class="md-tabs__link">
          
  
  Developer's Guide

        </a>
      </li>
    
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../assets/src-docs/index.html" class="md-tabs__link">
        
  
    
  
  Code Reference

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../reference_docs.html" class="md-tabs__link">
        
  
    
  
  Reference documents

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../change_history.html" class="md-tabs__link">
        
  
    
  
  Change history

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../contacts.html" class="md-tabs__link">
        
  
    
  
  Contacts

      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


  

<nav class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../index.html" title="EnduroSat On-Board Computer SDK Documentation" class="md-nav__button md-logo" aria-label="EnduroSat On-Board Computer SDK Documentation" data-md-component="logo">
      
  <img src="../EnduroSat_horLogo_symbol@2x-min.png" alt="logo">

    </a>
    EnduroSat On-Board Computer SDK Documentation
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../index.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../quickstart.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Quick-start Guide
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
      
        
        
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Developer's Guide
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Developer's Guide
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="hldesign.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    High-Level Design
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="devguide_dirstructure.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Directory structure
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="devguide_cmake.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Build structure
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_4" >
        
          
          <label class="md-nav__link" for="__nav_3_4" id="__nav_3_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    OBC configuration
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_4">
            <span class="md-nav__icon md-icon"></span>
            OBC configuration
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="devguide_buildcfg.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Build-time configuration
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="devguide_sysconfig.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Run-time configuration
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_5" checked>
        
          
          <label class="md-nav__link" for="__nav_3_5" id="__nav_3_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Development recipes
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_5_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3_5">
            <span class="md-nav__icon md-icon"></span>
            Development recipes
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="devguide_newcomp.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Extending the SDK with new components
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="devguide_esps_cmd_extend.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Extending the set of OBC supported commands
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Bootloader and firmware updates handling
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="devguide_fwupd.html" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Bootloader and firmware updates handling
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#bootloader" class="md-nav__link">
    <span class="md-ellipsis">
      Bootloader
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#obc-sdk-firmware-updates" class="md-nav__link">
    <span class="md-ellipsis">
      OBC SDK firmware updates
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#flashing-application-binaries-via-the-obc-bootloader" class="md-nav__link">
    <span class="md-ellipsis">
      Flashing application binaries via the OBC Bootloader
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#flashing-application-bundles-via-the-obc-bootloader" class="md-nav__link">
    <span class="md-ellipsis">
      Flashing application bundles via the OBC Bootloader
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#resuming-an-interrupted-bundle-upload" class="md-nav__link">
    <span class="md-ellipsis">
      Resuming an interrupted bundle upload
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="devguide_debugtrace.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Debug and trace
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="devguide_assertions.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Assertions
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="devguide_datacache.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Data Cache
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="devguide_telemetry.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Telemetry
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="devguide_micropython.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    MicroPython
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="devguide_es_adcs.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    EnduroSat ADCS
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_5_10" >
        
          
          <label class="md-nav__link" for="__nav_3_5_10" id="__nav_3_5_10_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Operations
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_5_10_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_5_10">
            <span class="md-nav__icon md-icon"></span>
            Operations
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="devguide_conops.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Concept of Operations
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="devguide_user_payloads.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    User Payloads
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="devguide_aocs.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Attitude and Orbit Control
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="devguide_payload_scheduler.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Payload Scheduler
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="devguide_cubeadcs_gen2_service.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    CubeADCS Gen2 Service
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="devguide_operations_guide.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Operations Guide
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="devguide_pm.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Performance monitor
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_6" >
        
          
          <label class="md-nav__link" for="__nav_3_6" id="__nav_3_6_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Connectivity
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_6">
            <span class="md-nav__icon md-icon"></span>
            Connectivity
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="devguide_eth.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Ethernet
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../assets/src-docs/index.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Code Reference
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference_docs.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Reference documents
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../change_history.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Change history
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../contacts.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Contacts
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  <h1>Bootloader and firmware updates handling</h1>

<h2 id="bootloader">Bootloader</h2>
<p>The <abbr title="On-board Computer">OBC</abbr> Bootloader is a programming image provided by EnduroSat which enables updates of the standard <abbr title="On-board Computer">OBC</abbr> application via:</p>
<ul>
<li><abbr title="EnduroSat Protocol Stack">ESPS</abbr> I (by wire)</li>
<li><abbr title="EnduroSat Protocol Stack">ESPS</abbr> I (<abbr title="Over-The-Air">OTA</abbr>)</li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>You should have received the EnduroSat Bootloader binary image as part of your <abbr title="On-board Computer">OBC</abbr> SDK purchase package.</p>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Bootloader image updates are only possible via the JTAG link cable and the <abbr title="ST Microelectronics">ST</abbr>-Link programmer!</p>
</div>
<p>When you receive your <abbr title="On-board Computer">OBC</abbr> board from EnduroSat, it will be originally flashed with the <abbr title="On-board Computer">OBC</abbr> Bootloader binary. Since you have full control over what gets written into your <abbr title="MicroController Unit">MCU</abbr> FLASH ROM, you can easily erase (accidentally or on purpose) the original EnduroSat Bootloader image from FLASH ROM. If that happens and you want to get back to your original board state, perform the following steps (it is assumed that you have the <code>STM32CubeProgrammer CLI</code> executable installed on your machine):</p>
<ol>
<li>Make sure your <abbr title="On-board Computer">OBC</abbr> board is not powered</li>
<li>Connect the <abbr title="ST Microelectronics">ST</abbr>-Link JTAG programmer to the <abbr title="On-board Computer">OBC</abbr> board</li>
<li>Connect the <abbr title="ST Microelectronics">ST</abbr>-Link JTAG programmer to your PC <abbr title="Universal Serial Bus">USB</abbr> port</li>
<li>Power on your <abbr title="On-board Computer">OBC</abbr> board</li>
<li>Open a command-line console and execute the following command:</li>
</ol>
<p><div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code>STM32_Programmer_CLI<span class="w"> </span>-c<span class="w"> </span><span class="nv">port</span><span class="o">=</span>JTAG<span class="w"> </span>--erase<span class="w"> </span>all<span class="w"> </span>--download<span class="w"> </span>&lt;OBC<span class="w"> </span>Bootloader<span class="w"> </span>bin<span class="w"> </span>file<span class="w"> </span>path&gt;<span class="w"> </span>0x08000000
</code></pre></div></td></tr></table></div>
You should see an output similar to the following:
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span></pre></div></td><td class="code"><div><pre><span></span><code>      -------------------------------------------------------------------
                       STM32CubeProgrammer v2.13.0
      -------------------------------------------------------------------

ST-LINK SN  : 36FF73064D59303615371643
ST-LINK FW  : V2J41S7
Board       : --
Voltage     : 3.28V
JTAG freq   : 9000 KHz
Connect mode: Normal
Reset mode  : Software reset
Device ID   : 0x450
Revision ID : Rev V
Device name : STM32H7xx
Flash size  : 2 MBytes
Device type : MCU
Device CPU  : Cortex-M7
BL Version  : 0x90


Mass erase ...

Mass erase successfully achieved


Memory Programming ...
Opening and parsing file: obc_bootloader.bin
  File          : obc_bootloader.bin
  Size          : 201.51 KB
  Address       : 0x08000000


Erasing memory corresponding to segment 0:
Erasing internal memory sectors [0 1]
Download in Progress:
��������������������������������������������������� 100%

File download complete
Time elapsed during download operation: 00:00:11.926
</code></pre></div></td></tr></table></div>
If everything went fine and you didn't get any errors during the process, the <abbr title="On-board Computer">OBC</abbr> green indicator LED will be blinking slowly at approx. 2-second intervals. This indicates you are in Bootloader mode. <br><br>From this point on, you can flash a new application bundle to the board by following the instructions in <a href="#flashing-application-binaries-via-the-obc-bootloader">Flashing application binaries via the <abbr title="On-board Computer">OBC</abbr> Bootloader</a> or <a href="#flashing-application-bundles-via-the-obc-bootloader">Flashing application bundles via the <abbr title="On-board Computer">OBC</abbr> Bootloader</a>.</p>
<h3 id="bootloaderapplication-data-interface">Bootloader/Application data interface</h3>
<p>If you are opting to use the standard EnduroSat bootloader, you have to be careful not to break the Bootloader/Application interface so that all functions of the system work as expected. Here is a short summary of the interfacing aspects between the Bootloader and the Application images:</p>
<ul>
<li>Firmware update image location on the on-board storage is set to the following mount point: <code>/sd/OBC_img.bin</code><ul>
<li>This file will be used as a firmware image to flash the <abbr title="On-board Computer">OBC</abbr> Application region after rebooting the system after an image file transfer. If you change the name of the file, the Bootloader will not be able to find it and the system will remain in Bootloader mode.</li>
</ul>
</li>
<li>Bootloader/Application shared <abbr title="Non-volatile memory (e.g. such as FLASH ROM, EEPROM, FRAM)">NVM</abbr> blocks<ul>
<li>These data blocks are placed at the beginning of the <abbr title="Ferroelectric Random Access Memory">FRAM</abbr> storage and contain data which is used by the Bootloader and the Application. It is recommended to keep these <abbr title="Non-volatile memory (e.g. such as FLASH ROM, EEPROM, FRAM)">NVM</abbr> blocks unchanged. These shared blocks can be found in <code>espf/config/nvm_bootcfg/inc/nvm_boot_block_ids.h</code> file.</li>
</ul>
</li>
</ul>
<h2 id="obc-sdk-firmware-updates"><abbr title="On-board Computer">OBC</abbr> SDK firmware updates</h2>
<p><abbr title="Firmware">FW</abbr> update functionality from the <abbr title="EnduroSat">ES</abbr> <abbr title="Ground Station">GS</abbr> is provided to the <abbr title="On-board Computer">OBC</abbr> module out-of-the-box. The file transfer is completely handled by the <abbr title="EnduroSat Protocol Stack">ESPS</abbr> I <abbr title="Firmware Update">FWUPD</abbr> protocol which ensures that you will have your update bundle stored on the <abbr title="Secure Digital (a flash memory card format)">SD</abbr> card when the operation is finished. The actual update is performed by the <code>FWUPD_Handler_Cfg.c::FWUPD_Handler_Cfg_HandleTransferComplete(...)</code> function.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Please have in mind that while the transfer of a firmware update image can be performed by both Application and Bootloader, the physical flashing of the <abbr title="On-board Computer">OBC</abbr> SDK firmware at the moment of writing this guide can only be performed by the Bootloader.</p>
</div>
<p>The procedure involves the following major steps:</p>
<ol>
<li>The transferred update file is stored on the <abbr title="Secure Digital (a flash memory card format)">SD</abbr> card.</li>
<li>A soft reset is performed in Bootloader mode.</li>
<li>Bootloader detects that a flash operation is requested and starts the procedure.</li>
<li>After flashing the application FLASH blocks, the Bootloader calculates a <abbr title="Cyclic Redundancy Check">CRC</abbr> of the flashed image and compares it to the <abbr title="Cyclic Redundancy Check">CRC</abbr> calculated from the image file.</li>
<li>If both CRCs match, the application is flashed correctly and a jump to the application image entry-point is performed; otherwise, the <abbr title="On-board Computer">OBC</abbr> remains in Bootloader mode waiting for another flashing attempt.</li>
</ol>
<p><a class="glightbox" href="../assets/plantuml/img/fwupd.svg" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="FW update sequence" src="../assets/plantuml/img/fwupd.svg" /></a></p>
<h3 id="my-payload-does-not-speak-esps-i-can-i-still-transfer-a-custom-payload-firmware-via-this-mechanism">My payload does not speak <abbr title="EnduroSat Protocol Stack">ESPS</abbr> I. Can I still transfer a custom payload firmware via this mechanism?</h3>
<p>Absolutely. If you already have specific payloads in your system which are managed by the <abbr title="On-board Computer">OBC</abbr> and they are not manufactured by EnduroSat, you can still use the same <abbr title="Firmware Update">FWUPD</abbr> mechanism to transfer update images for those payloads. As a matter of fact, you can transport any file via this mechanism. You are free to implement your custom handling for those images in the <code>FWUPD_Handler_Cfg.c::FWUPD_Handler_Cfg_HandleTransferComplete(...)</code> function. Read on for more details on how to do that with the <abbr title="On-board Computer">OBC</abbr> SDK.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Please have in mind, that the current operating speeds of the <abbr title="EnduroSat Protocol Stack">ESPS</abbr> I bus is fairly low so bigger images may take a very long time to transfer. This mechanism is only suitable for exchanging smaller files, e.g. on the order of several hundred bytes.</p>
</div>
<p>Let's inspect the <code>FWUPD_Handler_Cfg_HandleTransferComplete(...)</code> prototype more closely...</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="c1">// This function is called whenever a new update image is received by the OBC and is ready to be processed</span>
<span class="kt">bool</span><span class="w"> </span><span class="n">FWUPD_Handler_Cfg_HandleTransferComplete</span><span class="p">(</span><span class="n">sTransferInfo_t</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">pTransferInfo</span><span class="p">,</span>
<span class="w">                                              </span><span class="k">const</span><span class="w"> </span><span class="kt">uint64_t</span><span class="w"> </span><span class="n">u64ActiveTransferId</span><span class="p">,</span>
<span class="w">                                              </span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">pFileName</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
<p>It provides the following information:</p>
<ul>
<li><code>pTransferInfo</code> which is a pointer to the update transfer context structure (it contains details on the actual type of update package which was uploaded)</li>
<li><code>u64ActiveTransferid</code> is an unique identifier assigned to this particular transfer session by the <abbr title="Ground Station">GS</abbr></li>
<li><code>pFileName</code> is the name of the file transferred on the <abbr title="Secure Digital (a flash memory card format)">SD</abbr> card</li>
</ul>
<p>The bundle header which can be accessed via <code>pTransferInfo-&gt;header</code> field is of type <code>SESSoftwareUPD_Bundle</code> and contains the following attributes:
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">typedef</span><span class="w"> </span><span class="k">struct</span>
<span class="p">{</span>
<span class="w">    </span><span class="n">SESSoftwareUPD_Hdr</span><span class="w"> </span><span class="n">hdr</span><span class="p">;</span>
<span class="w">    </span><span class="kt">uint16_t</span><span class="w"> </span><span class="n">nSubModule</span><span class="p">;</span>
<span class="w">    </span><span class="kt">uint16_t</span><span class="w"> </span><span class="n">nModuleType</span><span class="p">;</span>
<span class="w">    </span><span class="kt">uint16_t</span><span class="w"> </span><span class="n">nModuleConfig</span><span class="p">;</span>
<span class="w">    </span><span class="kt">uint16_t</span><span class="w"> </span><span class="n">nBoardRevision</span><span class="p">;</span>
<span class="w">    </span><span class="kt">uint16_t</span><span class="w"> </span><span class="n">nCPUType</span><span class="p">;</span>
<span class="w">    </span><span class="kt">uint16_t</span><span class="w"> </span><span class="n">nFWType</span><span class="p">;</span>
<span class="w">    </span><span class="kt">uint16_t</span><span class="w"> </span><span class="n">nFWVerMaj</span><span class="p">;</span>
<span class="w">    </span><span class="kt">uint16_t</span><span class="w"> </span><span class="n">nFWVerMin</span><span class="p">;</span>
<span class="w">    </span><span class="kt">uint64_t</span><span class="w"> </span><span class="n">nFlags</span><span class="p">;</span>
<span class="p">}</span><span class="w"> </span><span class="n">SESSoftwareUPD_Bundle</span><span class="p">;</span>
</code></pre></div></td></tr></table></div></p>
<p><code>SESSoftwareUPD_Bundle::nModuleType</code> has a fixed value of <code>FW_OBC_SUBMODULE_SELF</code> for <abbr title="On-board Computer">OBC</abbr> <abbr title="Firmware">FW</abbr> updates by default (this defined in the <code>Middlewares/TPLayerUser/FWUPD_Handler_Cfg.h</code> header).</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>As all header fields are assigned to the update image at the time of preparation on the <abbr title="Ground Station">GS</abbr>, you can use these fields to perform specific checks about your update image or simply define a <em>special</em> type of image which you can identify based on this header and process in a specific way when received on the <abbr title="On-board Computer">OBC</abbr>.</p>
<p>Considering this, the <abbr title="Firmware Update">FWUPD</abbr> mechanism is actually quite generic and can also be used for other purposes such as uploading NVRAM content, uploading a settings file to your device or transferring update images for <abbr title="On-board Computer">OBC</abbr>-connected slave devices which do not speak the <abbr title="EnduroSat Protocol Stack">ESPS</abbr> I protocol and do not have a connection to the <abbr title="Serial Communication Protocol">RS-485</abbr> bus.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The original implementation of the <abbr title="Firmware Update">FWUPD</abbr> protocol was never intended to transfer files but rather binary images for memory-constrained devices. As such, the original protocol does not give the users a way to specify a file name. <abbr title="On-board Computer">OBC</abbr> will store whatever data is received in a file called <code>OBC_IMG.BIN</code> by default. The <abbr title="On-board Computer">OBC</abbr> SDK however provides a specific protocol extension to support naming uploaded data images via the <abbr title="Firmware Update">FWUPD</abbr> protocol. It is called a <code>meta-data footer block</code> which gets appended to the <abbr title="Firmware Update">FWUPD</abbr> bundle. The only specific requirement for the update bundle header is to use the <code>FW_OBC_MODULE_TYPE (0)</code> value for the <code>nModuleType</code> field. The existence of this meta-data block is verified by the example implementation of the <code>FWUPD_Handler_Cfg_HandleTransferComplete</code> function and if the block exists, the uploaded data is stored on the <abbr title="Secure Digital (a flash memory card format)">SD</abbr> card using the <code>file_name</code> field value from the footer structure.</p>
<p>The <code>footer block</code> binary structure is defined as:</p>
<table>
<thead>
<tr>
<th>Field name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>ext_bun_sig</td>
<td><code>uint8[7]</code></td>
<td>extended bundle footer signature in ASCII, fixed to the string <code>EXT_BUN</code> (no terminating NULL character)</td>
</tr>
<tr>
<td>file_name</td>
<td><code>uint8[47]</code></td>
<td>ASIIZ file name to use for storing the received data on the <abbr title="Secure Digital (a flash memory card format)">SD</abbr> card</td>
</tr>
<tr>
<td>ext_bun_crc</td>
<td><code>uint16</code></td>
<td>CRC16-CCITT of all footer fields (poly: <code>0x1021</code>, seed: <code>0xFFFF</code>)</td>
</tr>
</tbody>
</table>
<p>On top of that, there is a generic file handling mechanism implemented which gets triggered as soon as a file is uploaded via the <abbr title="Firmware Update">FWUPD</abbr> protocol. The handling of files is based on their extension. If you would like to register your own file extension to handle in a specific way, here are the steps you should perform (we will assume that you want to handle the <code>zip</code> file extension):</p>
<ul>
<li>
<p>create a file extension handler function which matches the function prototype defined by type <code>p_file_handler_t</code>:
    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">zip_handler</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">p_file_name</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">    </span><span class="c1">// handle p_file_name as a ZIP file</span>
<span class="p">}</span>
</code></pre></div></td></tr></table></div></p>
</li>
<li>
<p>extend the <code>file_ext_map</code> array with your new <code>zip</code> entry:
    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">static</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">file_ext_map_t</span><span class="w"> </span><span class="n">file_ext_map</span><span class="p">[</span><span class="n">EXT_MAP_ENTRIES_CNT</span><span class="p">]</span><span class="w"> </span><span class="o">=</span>
<span class="p">{</span>
<span class="w">    </span><span class="p">...,</span>
<span class="w">    </span><span class="p">{</span><span class="w"> </span><span class="p">.</span><span class="n">uppercase_ext</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;ZIP&quot;</span><span class="p">,</span><span class="w"> </span><span class="p">.</span><span class="n">lowercase_ext</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;zip&quot;</span><span class="p">,</span><span class="w"> </span><span class="p">.</span><span class="n">p_file_ext_handler</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">&amp;</span><span class="n">zip_handler</span><span class="w"> </span><span class="p">},</span>
<span class="p">};</span>
</code></pre></div></td></tr></table></div>
    <img alt="❗" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.0.3/assets/svg/2757.svg" title=":exclamation:" /> <em>Do not forget to update the <code>EXT_MAP_ENTRIES_CNT</code> value</em></p>
</li>
<li>
<p>Upload a <code>zip</code> file to the <abbr title="On-board Computer">OBC</abbr> using the mechanism described here and your new <code>zip_handler</code> function will be called when the upload finishes providing the name of the file as an argument.<sup id="fnref:1"><a class="footnote-ref" href="#fn:1">1</a></sup></p>
</li>
</ul>
</div>
<h3 id="os-tasks"><abbr title="Operating System">OS</abbr> tasks</h3>
<table>
<thead>
<tr>
<th>Task name</th>
<th>Defined in...</th>
<th>Execution policy</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>MACTLDrvTask</td>
<td>ESSA_Stack_TP_Layer.c</td>
<td>Periodic @ 50 ms</td>
<td>main <abbr title="EnduroSat Protocol Stack">ESPS</abbr> I Transport Layer task driver (<abbr title="ESPS I Command Protocol">CP</abbr> commands get scheduled by a call to the <code>CP_Handler.c::CP_Handler_Task()</code> function)</td>
</tr>
<tr>
<td>FwUpdateTask</td>
<td>FWUPD_Handler.c</td>
<td>Event/Periodic @ 20 ms</td>
<td><abbr title="Firmware Update">FWUPD</abbr> task which handles incoming packets from <abbr title="EnduroSat Protocol Stack">ESPS</abbr> <abbr title="Firmware Update">FWUPD</abbr> protocol and persists them on the <abbr title="Secure Digital (a flash memory card format)">SD</abbr> card</td>
</tr>
</tbody>
</table>
<h2 id="flashing-application-binaries-via-the-obc-bootloader">Flashing application binaries via the <abbr title="On-board Computer">OBC</abbr> Bootloader</h2>
<p>Usually, when your project is in the active development phase, you will be directly flashing the <abbr title="On-board Computer">OBC</abbr> via the <abbr title="ST Microelectronics">ST</abbr>-Link JTAG programmer during debugging using <code>noboot</code> images which do not require the presence of a bootloader on the <abbr title="On-board Computer">OBC</abbr> board.<br></p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>When testing your final releases, the release images can only be flashed by the EnduroSat Bootloader which must be provisioned on your board in advance (see <a href="#bootloader">Bootloader section</a> for details). Once this is done, you can use <abbr title="EnduroSat OBC build system wrapper which provides a user-friendly command-line interface to the most commonly used build and flashing operations">macaron</abbr> to streamline your flashing experience as the preparation of an application bundle contains a few steps which you may not want to perform manually to avoid errors:</p>
</div>
<ol>
<li>
<p>build your <abbr title="On-board Computer">OBC</abbr> image in a <code>debug</code> or <code>release</code> configuration (check <a href="devguide_cmake.html#building-obc-sdk-from-the-console-via-macaron">Building <abbr title="On-board Computer">OBC</abbr> SDK from the console via <abbr title="EnduroSat OBC build system wrapper which provides a user-friendly command-line interface to the most commonly used build and flashing operations">macaron</abbr></a> for more details)
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nb">cd</span><span class="w"> </span>&lt;OBC_ROOT&gt;/build
python<span class="w"> </span>macaron.py<span class="w"> </span>-b<span class="w"> </span>release
</code></pre></div></td></tr></table></div></p>
</li>
<li>
<p>now flash the produced binary image in the <code>./release</code>  folder by typing the following in the console:
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code>python<span class="w"> </span>macaron.py<span class="w"> </span>--flash-bin<span class="w"> </span>./release/OBC_STDPF_STM32H_release.bin<span class="w"> </span>--dongle-port<span class="w"> </span>&lt;your<span class="w"> </span>dongle<span class="w"> </span>com<span class="w"> </span>port<span class="w"> </span>id&gt;<span class="w"> </span>--obc-mac-addr<span class="w"> </span>&lt;OBC<span class="w"> </span>ESPS<span class="w"> </span>MAC<span class="w"> </span>address&gt;
</code></pre></div></td></tr></table></div>
<em>By default, the <abbr title="On-board Computer">OBC</abbr> <abbr title="EnduroSat Protocol Stack">ESPS</abbr> <abbr title="Media Access Control">MAC</abbr> address is set to <code>0x33</code> so if you didn't change it yourself, you must use this value.</em></p>
</li>
</ol>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>If you only want to create a bundle which you would give to someone else for flashing the <abbr title="On-board Computer">OBC</abbr>, then you can use the following command line:
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code>python<span class="w"> </span>macaron.py<span class="w"> </span>--create-app-bundle<span class="w"> </span>./release/OBC_STDPF_STM32H_release.bin
</code></pre></div></td></tr></table></div>
You should see an output similar to the following:
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span></pre></div></td><td class="code"><div><pre><span></span><code>Endurosat -macaron- build front-end [v0.3]
macaron.py started with args: Namespace(build=None, release_ver=None, clean=False, clean_gen_content=WindowsPath(&#39;.&#39;), fp_gen=False, datacache_gen=False, fp_gen_all=False, depl_config=&#39;&#39;, fp_merge_root=WindowsPath(&#39;.&#39;), verbose=False, error_out_only=False, reset_log=False, flash_bin=None, dongle_port=None, obc_mac_addr=51, create_app_bundle=WindowsPath(&#39;C:/Projects/SWP/GitRepo/obc-stdpf-hw-1.x
           0 00 00                                              ................
          16  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  ................
          32  00 00 00 00 00 00 EB 53  B7 A4                    .......S..
        2023/09/08 18:51:53 FWUpd header with size 7 serialized:
           0  DF 9B 57 13 01 00 00                              ..W....
        2023/09/08 18:51:53 Bundle parameters with size 24 serialized:
           0  00 00 06 00 01 00 01 00  01 00 01 00 00 00 00 00  ................
          16  00 00 00 00 00 00 00 00                           ........
        2023/09/08 18:51:53 Bundle exported successfully
&gt;  command finished successfully!
OBC application bundle created here: &quot;C:\Projects\SWP\GitRepo\obc-stdpf-hw-1.x-dev\build\release\OBC_STDPF_STM32H_release.bin.bun&quot;
</code></pre></div></td></tr></table></div></p>
</div>
<h2 id="flashing-application-bundles-via-the-obc-bootloader">Flashing application bundles via the <abbr title="On-board Computer">OBC</abbr> Bootloader</h2>
<p>If you want to flash a prebuilt bundle file directly, you can use the following command in the console:
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code>python<span class="w"> </span>macaron.py<span class="w"> </span>--flash-bun<span class="w"> </span>&lt;bundle<span class="w"> </span>file<span class="w"> </span>path&gt;<span class="w"> </span>--dongle-port<span class="w"> </span>&lt;your<span class="w"> </span>dongle<span class="w"> </span>com<span class="w"> </span>port<span class="w"> </span>id&gt;<span class="w"> </span>--obc-mac-addr<span class="w"> </span>&lt;OBC<span class="w"> </span>ESPS<span class="w"> </span>MAC<span class="w"> </span>address&gt;
</code></pre></div></td></tr></table></div></p>
<h2 id="resuming-an-interrupted-bundle-upload">Resuming an interrupted bundle upload</h2>
<p>If you start the application bundle flashing procedure, your image must first be uploaded to the <abbr title="On-board Computer">OBC</abbr> board. With the current physical interface and baud-rate used, it takes a few minutes for an average binary of several hundred kilobytes to transfer via a dongle. You could also be doing this over a radio dongle which requires more time. If something happens during the transfer, it can potentially get interrupted. Fortunately, you can still continue the transfer from where it stopped by using a special command line parameter which you can pass to <abbr title="EnduroSat OBC build system wrapper which provides a user-friendly command-line interface to the most commonly used build and flashing operations">macaron</abbr>. It is called a <code>session-id</code>.</p>
<div class="admonition info">
<p class="admonition-title">Info</p>
<p>A <code>session-id</code> is a unique identifier of the communication session established between the satellite and the ground segment (or a test PC when testing in the lab). By default <code>session-id</code>s get generated randomly upon the start of a new transfer. They are printed as part of the debug output during a flashing session. Here is a simple flashing session log:</p>
<p><div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span></pre></div></td><td class="code"><div><pre><span></span><code>Endurosat -macaron- build front-end [v0.3]
macaron.py started with args: Namespace(build=None, release_ver=None, clean=False, clean_gen_content=WindowsPath(&#39;.&#39;), fp_gen=False, datacache_gen=False, fp_gen_all=False, depl_config=&#39;&#39;, fp_merge_root=WindowsPath(&#39;.&#39;), verbose=False, error_out_only=False, reset_log=False, flash_bin=None, flash_bun=WindowsPath(&#39;release/OBC_STDPF_STM32H_release.bin.bun&#39;), session_id=462308182, dongle_port=&#39;6&#39;, obc_mac_addr=52, create_app_bundle=None)
ESPF_ROOT_BUILD_PATH environment variable not set. Using default path setting resolving to &quot;C:\Projects\SWP\GitRepo\obc-stdpf-hw-1.x-dev&quot;.
cleaning up all directories with name &quot;src-gen-c&quot; under &quot;C:\Projects\SWP\GitRepo\obc-stdpf-hw-1.x-dev\build&quot;...
starting bundle app flash procedure: &quot;C:\Projects\SWP\GitRepo\obc-stdpf-hw-1.x-dev\other\tools\GSEmulation.exe --com 6 --protocol FWUPD --network-type RS485 --test-type 0 --source-addr 1 --dest-module-addr 52 --satellite-id 0 --input-file C:\Projects\SWP\GitRepo\obc-stdpf-hw-1.x-dev\build\release\OBC_STDPF_STM32H_release.bin.bun --verbose 1 --tl_packet-id 462308182&quot;
        [2023/09/11 13:33:32.695] StandAloneThread thread : started
        Entering CESTL_Drv::Init(): 1
         ++++++++ CESTL_Sender::StartTransfer::nTLHostContext: 9223372037317083990
        s
        Send FW Bundle [462308182]
        a
        [Restarted @ 34.4 %]
        [24576]ddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddsa[24576] | 37.88
        [24576]ddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddsa[24576] | 41.36
        [24576]ddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddsa[24576] | 44.83
        [24576]ddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddsa[24576] | 48.31
        [24576]ddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddsa[24576] | 51.78
        [24576]ddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddsa[24576] | 55.26
        [24576]ddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddsa[24576] | 58.74
        [24576]ddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddsa[24576] | 62.21
        [24576]ddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddsa[24576] | 65.69
        [24576]ddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddsa[24576] | 69.16
        [24576]ddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddsa[24576] | 72.64
        [24576]ddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddsa[24576] | 76.12
        [24576]ddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddsa[24576] | 79.59
        [24576]ddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddsa[24576] | 83.07
        [24576]ddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddsa[24576] | 86.54
        [24576]ddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddsa[24576] | 90.02
        [24576]ddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddsa[24576] | 93.50
        [24576]ddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddsa[24576] | 96.97
        [21400]dddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddsa[21400] | 100.00
        SA
        [13]DSA[13] | 100% Transfer Completed
        Status : [SESUL_UPLS_WAITING] Upload received ok, and pending for update, Err : [SESUL_UPLE_SUCCESS] No error
         ++++++++ CESTL_Sender::StartTransfer::nTLHostContext: 462308182
        s
        Send UPD CMD [462308182] a
        [Restarted @ 0.0 %]
        [11]dsa[11] | 100.00
        SA
        [13]DSA[13] | 100% Transfer Completed
        Status : [SESUL_UPLS_WAITING] Upload received ok, and pending for update, Err : [SESUL_UPLE_SUCCESS] No error
         ++++++++ CESTL_Sender::StartTransfer::nTLHostContext: 462308182
        s
        Send UPD CMD [462308182] a
        [Restarted @ 0.0 %]
        [11]dsa[11] | 100.00
         ++++++++ CESTL_Sender::StartTransfer::nTLHostContext: 462308182
        s
        Send UPD CMD [462308182] a
        [Restarted @ 0.0 %]
        [11]dsa[11] | 100.00
        ===============================================
        SUCCESS
&gt;  command finished successfully!
</code></pre></div></td></tr></table></div>
The <code>session-id</code> is given at line <code>10</code> in square brackets =&gt; <code>462308182</code>.</p>
</div>
<p>If your transfer interrupts for some reason, you can easily continue the transfer by specifying its original <code>session-id</code> at the command line as follows:
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code>python<span class="w"> </span>macaron.py<span class="w"> </span>--flash-bin<span class="w"> </span>./release/OBC_STDPF_STM32H_release.bin<span class="w"> </span>--dongle-port<span class="w"> </span>&lt;your<span class="w"> </span>dongle<span class="w"> </span>com<span class="w"> </span>port<span class="w"> </span>id&gt;<span class="w"> </span>--obc-mac-addr<span class="w"> </span>&lt;OBC<span class="w"> </span>ESPS<span class="w"> </span>MAC<span class="w"> </span>address&gt;<span class="w"> </span>--session-id<span class="w"> </span><span class="m">462308182</span>
</code></pre></div></td></tr></table></div></p>
<p>If the <code>session-id</code> you specified is the same as the session registered in the <abbr title="On-board Computer">OBC</abbr>, the transfer will just continue from where it left off, otherwise the transfer will be restarted with the <code>session-id</code> you specified.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>If you don't want to scan flash logs to recover the <code>session-id</code> for your transfer, you can directly specify it via the <code>--sesssion-id</code> <abbr title="EnduroSat OBC build system wrapper which provides a user-friendly command-line interface to the most commonly used build and flashing operations">macaron</abbr> parameter when you first start the transfer. If the transfer breaks, just run the same command in the console and it will continue your transfer right away.</p>
</div>
<div class="footnote">
<hr />
<ol>
<li id="fn:1">
<p>This mechanism only works with <abbr title="Firmware Update">FWUPD</abbr> file uploads. If the file is uploaded via the FileManager <abbr title="Function Protocol (a custom command and query protocol for ESPS I)">FP</abbr> <abbr title="Application Programming Interface">API</abbr>, the handler will not be called.&#160;<a class="footnote-backref" href="#fnref:1" title="Jump back to footnote 1 in the text">&#8617;</a></p>
</li>
</ol>
</div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
  Back to top
</button>
        
      </main>
      
        
<footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="footer.title">
      
        
        <a href="devguide_esps_cmd_extend.html" class="md-footer__link md-footer__link--prev" aria-label="Previous: Extending the set of OBC supported commands" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              Extending the set of OBC supported commands
            </div>
          </div>
        </a>
      
      
        
        <a href="devguide_debugtrace.html" class="md-footer__link md-footer__link--next" aria-label="Next: Debug and trace" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              Debug and trace
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
          <div class="md-footer-copyright__highlight">
            <i>Privileged and confidential</i>
          </div>
        
      </div>
      <div class="md-social">
  
    
    
    
    
    <a href="https://www.linkedin.com/company/endurosat/" target="_blank" rel="noopener" title="EnduroSat on LinkedIn" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"/></svg>
    </a>
  
</div>
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
<script id="__config" type="application/json">{"base": "..", "features": ["content.code.copy", "content.code.annotate", "search.suggest", "search.highlight", "search.share", "navigation.tabs", "navigation.top", "toc.integrate"], "search": "../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    


    
      <script src="../assets/javascripts/bundle.ad660dcc.min.js"></script>
      
        <script src="../javascripts/mathjax.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  <script id="init-glightbox">const lightbox = GLightbox({"touchNavigation": true, "loop": false, "zoomable": true, "draggable": true, "openEffect": "zoom", "closeEffect": "zoom", "slideEffect": "slide"});
document$.subscribe(() => { lightbox.reload() });
</script></body>
</html>