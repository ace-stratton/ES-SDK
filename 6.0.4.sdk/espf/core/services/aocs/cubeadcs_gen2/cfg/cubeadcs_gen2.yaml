---
cubeadcs_gen2_sm:
  states:
    - Backoff:
        transitions:
            - EventMarkerAcquisition:
              - { event: "__periodic", guard: is_adcs_ready }
        attributes:
            on_exit: False
    - EventMarkerAcquisition:
        transitions:
            - Check: 
              - { event: event_marker_acquired }
        attributes:
            on_entry: False
            on_exit: False        
    - Idle:
        transitions:
            - Check:
                - { event: "__periodic", guard: is_time_to_check_expired }
            - EventDownload:
                - { event: "__periodic", guard: is_time_to_event_download_expired }    
            - StateChange:
                - { event: request_a_state_change, guard: is_state_change_valid }
        attributes:
            on_exit: False
    - Check:
        transitions:
            - FDIR:
                - { event: request_fdir }
            - Idle:
                - { event: check_completed }
        attributes:
            on_entry: False
            on_exit: False
    - EventDownload:
        transitions:
            - Idle:
                - { event: event_download_completed }
            - FDIR:
                - { event: request_fdir }    
        attributes:
            on_exit: False        
    - StateChange:
        transitions:
            - FDIR:
                - { event: request_fdir }
            - Idle:
                - { event: state_change_completed }
        attributes:
            on_exit: True
    - FDIR:
        transitions:
            - Idle:
                - { event: fdir_completed, action: notify_users }
        attributes:
            on_entry: False
            on_exit: False               
  attributes:
    initial: Backoff
